<!DOCTYPE html>
<html class="no-js" lang="en-us">
<head>
    <!-- Basic Page Needs -->

    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta property="og:title"       content="The Weekly Challenge"/>
    <meta property="og:type"        content="website"/>
    <meta property="og:url"         content="https://theweeklychallenge.org/"/>
    <meta property="og:image"       content="https://theweeklychallenge.org/images/about/about.jpg"/>
    <meta property="og:description" content="You do not have to be an expert."/>
    <meta name="twitter:card"       content="summary" />
    <meta name="twitter:image"      content="https://theweeklychallenge.org/images/about/about.jpg"/>

    <meta http-equiv="Content-Type" content="text/html; charset=utf-8">

    <meta name="description" content="Laurent Rosenfeld Weekly Review: Challenge - #027.">
    <meta name="author" content="The Weekly Challenge Team">
    <meta name="generator" content="Hugo 0.67.0-DEV" />

    <link rel="me" href="https://fosstodon.org/@manwar">

    <!-- Mobile Specific Metas -->
    <meta name="format-detection" content="telephone=no">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Laurent Rosenfeld Weekly Review: Challenge - 027</title>
    <link rel="icon" href="https://theweeklychallenge.org/images/favicon.ico">

    
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.0/css/bootstrap.min.css"/>

    <!-- Twitter Bootstrs CSS -->
    <link rel="stylesheet" href="https://theweeklychallenge.org/plugins/bootstrap/bootstrap.min.css">
    <!-- Ionicons Fonts Css -->
    <link rel="stylesheet" href="https://theweeklychallenge.org/plugins/ionicons/ionicons.min.css">
    <!-- animate css -->
    <link rel="stylesheet" href="https://theweeklychallenge.org/plugins/animate-css/animate.css">
    <!-- Hero area slider css-->
    <link rel="stylesheet" href="https://theweeklychallenge.org/plugins/slider/slider.css">
    <!-- slick slider -->
    <link rel="stylesheet" href="https://theweeklychallenge.org/plugins/slick/slick.css">
    <!-- Fancybox -->
    <link rel="stylesheet" href="https://theweeklychallenge.org/plugins/facncybox/jquery.fancybox.css">
    <!-- hover -->
    <link rel="stylesheet" href="https://theweeklychallenge.org/plugins/hover/hover-min.css">
    <!-- Google fonts -->
    <link href='https://fonts.googleapis.com/css?family=Source Code Pro' rel='stylesheet'>
    <!-- template main css file -->
    
    <link rel="stylesheet" href="https://theweeklychallenge.org/css/style.min.css" integrity="" media="screen">
    <link rel="stylesheet" href="https://theweeklychallenge.org/css/main.css">

    <style>
        #goTopButton {
            display: none;          
            position: fixed;        
            bottom: 20px;           
            right: 30px;            
            z-index: 99;            
            border: none;           
            outline: none;          
            background-color: red;  
            color: white;           
            cursor: pointer;        
            padding: 15px;          
            border-radius: 10px;    
            font-size: 18px;        
        }

        #goTopButton:hover {
              background-color: #555;
        }
    </style>


</head>

<body>

<button onclick="goTop()" id="goTopButton" title="Go to top">Top</button>

<script>

    topButton = document.getElementById("goTopButton");

    
    window.onscroll = function() { scrollFunction() };

    function scrollFunction() {
        if (document.body.scrollTop > 40 || document.documentElement.scrollTop > 40) {
            topButton.style.display = "block";
        } else {
            topButton.style.display = "none";
        }
    }

    
    function goTop() {
        document.body.scrollTop = 0; 
        document.documentElement.scrollTop = 0; 
    }

</script>

<section class="top-bar animated-header">
    <div class="container">
        <div class="row">
            <div class="col-lg-12">
                <nav class="navbar navbar-expand-lg navbar-light bg-light">
                    <a class="navbar-brand" href="https://theweeklychallenge.org/">
                        <img src="https://theweeklychallenge.org/images/logo.svg" alt="logo">
                    </a>
                    <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navgation" aria-controls="navigation"
                        aria-expanded="false" aria-label="Toggle navigation">
                        <span class="navbar-toggler-icon"></span>
                    </button>

                    <div class="collapse navbar-collapse" id="navigation">
                        <ul class="navbar-nav ml-auto">
                            <li class="nav-item">
                                <a class="nav-link" href="https://theweeklychallenge.org/">Home</a>
                            </li>
                            
                            <li class="nav-item">
                                <a class="nav-link" href="https://theweeklychallenge.org/about">About</a>
                            </li>
                            
                            <li class="nav-item">
                                <a class="nav-link" href="https://theweeklychallenge.org/chart">Chart</a>
                            </li>
                            
                            <li class="nav-item">
                                <a class="nav-link" href="https://theweeklychallenge.org/champions">Champions</a>
                            </li>
                            
                            <li class="nav-item">
                                <a class="nav-link" href="https://theweeklychallenge.org/team">Team</a>
                            </li>
                            
                            <li class="nav-item">
                                <a class="nav-link" href="https://theweeklychallenge.org/challenges">Challenges</a>
                            </li>
                            
                            <li class="nav-item">
                                <a class="nav-link" href="https://theweeklychallenge.org/p5-reviews">Perl/Review</a>
                            </li>
                            
                            <li class="nav-item">
                                <a class="nav-link" href="https://theweeklychallenge.org/p6-reviews">Raku/Review</a>
                            </li>
                            
                            <li class="nav-item">
                                <a class="nav-link" href="https://theweeklychallenge.org/recaps">Recaps</a>
                            </li>
                            
                            <li class="nav-item">
                                <a class="nav-link" href="https://theweeklychallenge.org/blogs">Blogs</a>
                            </li>
                            
                            <li class="nav-item">
                                <a class="nav-link" href="https://theweeklychallenge.org/faq">FAQ</a>
                            </li>
                            
                            <li class="nav-item">
                                <a class="nav-link" href="https://theweeklychallenge.org/contact">Contact</a>
                            </li>
                            
                        </ul>
                    </div>
                </nav>
            </div>
        </div>
    </div>
</section>


<section class="global-page-header">
    <div class="container">
        <div class="row">
            <div class="col-md-12">
                <div class="block">
                    <h2>Laurent Rosenfeld Weekly Review: Challenge - 027</h2>
                    <div class="portfolio-meta">
                        <span>Wednesday, Oct 9, 2019</span>|
                        <span> Tags:
                            Raku
                        </span>
                    </div>
                </div>
            </div>
        </div>
    </div>
</section>

<section class="single-post">
    <div class="container">
        <div class="row">
            <div class="col-md-12">
                
                <div style="text-align: center" class="post-img">
                    <img class="img-fluid" alt="" src="https://theweeklychallenge.org/images/blog/p6-review-challenge-027.jpg">
                </div>
                
                <div style="text-align: justify" class="post-content">
                    <hr>
<h1 id="raku-solutions-weekly-review">Raku Solutions Weekly Review</h1>
<hr>
<h2 id="task-1-intersection-of-two-straight-lines">Task #1: Intersection of Two Straight Lines</h2>
<p>This is derived in part from my <a href="http://blogs.perl.org/users/laurent_r/2019/09/perl-weekly-challenge-27-intersection-point-and-historical-values.html">blog post</a> made in answer to the <a href="https://perlweeklychallenge.org/blog/perl-weekly-challenge-027/">Week 27 of the Perl Weekly Challenge</a> organized by  <a href="http://blogs.perl.org/users/mohammad_s_anwar/">Mohammad S. Anwar</a> as well as answers made by others to the same challenge.</p>
<p>The challenge reads as follows:</p>
<p><em>Write a script to find the intersection of two straight lines. The co-ordinates of the two lines should be provided as command line parameter. For example:</em></p>
<blockquote>
<p><em>The two ends of Line 1 are represented as co-ordinates (a,b) and (c,d).</em></p>
</blockquote>
<blockquote>
<p><em>The two ends of Line 2 are represented as co-ordinates (p,q) and (r,s).</em></p>
</blockquote>
<p><em>The script should print the co-ordinates of point of intersection of the above two lines.</em></p>
<h2 id="some-background-knowledge-on-the-subject">Some Background Knowledge on the Subject</h2>
<p>This is really elementary math, but, as I haven&rsquo;t used any linear algebra for decades, I needed about 10 to 15 minutes with a pencil and a piece of paper to work out how to find the equation of a straight line going through two points and how to compute the intersection of two lines. For the benefits of those of you in the same situation, let me briefly summarize how this works. You may jump to the next section if you don&rsquo;t need any refresher on these subjects.</p>
<p>The equation of a straight line is usually written as <code>y = ax + b</code> (or, in some countries, <code>y = mx + b</code> or <code>y = mx + c</code>, but it&rsquo;s just the name of the coefficients changing), where <code>x</code> and <code>y</code> are the coordinates of any point belonging to the line, <code>a</code> is the slope (or gradient, i.e. how steep the line is) of the line, and <code>b</code> the y-intercept (the value of <code>y</code> when <code>x</code> is zero, or the place where the line crosses the <code>Y</code> axis). The slope is the change in <code>y</code> divided by the change in <code>x</code>. For finding the slope of a line going through two points with coordinates <code>x1, y1</code> and <code>x2, y2</code>, the slope <code>a</code> is the ordinate (<code>y</code>) difference of the points divided by their abscissa (<code>x</code>) difference:</p>
<pre><code>a = (y2 - y1) / (x2 - x1)
</code></pre>
<p>Of course, we have a division by zero problem if <code>x2</code> equals <code>x1</code> (i.e. the line is vertical, at least in an orthonormal base or Cartesian plane), but we&rsquo;ll come back to that special edge case later, as this does not necessarily preclude us from finding an interception point.</p>
<p>For finding the y-intercept (<code>b</code>), you just need to reformulate <code>y = ax + b</code> as <code>b = y - ax</code>, and to replace <code>a</code> by the slope found with the above formula, and <code>y</code> and <code>x</code> by the coordinates of any of the two points.</p>
<p>For finding the intersection point of two lines <code>y = a1 * x + b1</code> and <code>y = a2 * x + b2</code>, you need to figure out that it is the point of the lines for which the ordinate (<code>y</code>) is the same for an equal value of the abscissa (<code>x</code>), i.e. write the following equations:</p>
<pre><code>a1 * x + b1 = a2 * x + b2
          &lt;=&gt;
(a1 - a2) *x = b2 - b1
          &lt;=&gt;
x = (b2 - b1) / (a1 - a2)
</code></pre>
<p>Once the abscissa <code>x</code> of the intersection has been found, it is easy to find its ordinate <code>y</code> using the equation of any of the two lines.</p>
<p>If the lines&rsquo; slopes are equal, then the equation above has a division by zero problem, which reflects the fact that the line segments defined by the point pairs are parallel or co-linear, meaning that the problem has no solution (there is no intersection point).</p>
<h2 id="my-solution">My solution</h2>
<p>With the above knowledge secured, it is fairly easy to write a Perl 6 program computing the intersection point of two lines defined by two point pairs. The basic algorithm is fairly simple, but it becomes a little bit complicated when we want to tackle all the edge cases (two points which are the same, vertical line, parallel lines, etc.).</p>
<p>There is one slight complication, though: if one (and only one) of the point pairs have points with the same abscissa, we cannot write a linear equation for that pair of points, but the straight line is nonetheless well defined (provided the ordinates are different): it is a vertical line where all point have the same abscissa (<code>x</code> value). We cannot write an equation for such a line, but may still find the intersection point with the other line: it is the point of that other line having this abscissa. This special case will account for quite a lot of code lines in our solution.</p>
<p>Another observation is that this type of problem calls for object-oriented programming (even though I&rsquo;m generally not a great OO fan). So, we will define a <code>Point</code> type and a <code>Segment</code> class (with two <code>Point</code> attributes) providing the <code>slope</code> and <code>y-intercept</code> methods to compute the equation of a line passing through the two points. The <code>Point</code> role also provides a <code>gist</code> method enabling pretty printing of the point coordinates when using the <code>say</code> built-in function on a <code>Point</code> instance.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-Perl6" data-lang="Perl6"><span style="color:#66d9ef">use</span> v6;

role Point {
    has $<span style="color:#960050;background-color:#1e0010">.</span>x;
    has $<span style="color:#960050;background-color:#1e0010">.</span>y;

    method gist {
        <span style="color:#66d9ef">return</span> <span style="color:#e6db74">&#34;\n- Abscissa: $.x\n- Ordinate: $.y.&#34;</span>;
    }
}
class Segment {
    has Point $<span style="color:#960050;background-color:#1e0010">.</span>start;
    has Point $<span style="color:#960050;background-color:#1e0010">.</span>end;

    method slope {
        <span style="color:#66d9ef">return</span> ($<span style="color:#960050;background-color:#1e0010">.</span>end<span style="color:#f92672">.</span>y <span style="color:#f92672">-</span> $<span style="color:#960050;background-color:#1e0010">.</span>start<span style="color:#f92672">.</span>y) <span style="color:#f92672">/</span> ($<span style="color:#960050;background-color:#1e0010">.</span>end<span style="color:#f92672">.</span>x <span style="color:#f92672">-</span> $<span style="color:#960050;background-color:#1e0010">.</span>start<span style="color:#f92672">.</span>x);
    }
    method y<span style="color:#f92672">-</span>intercept {
        <span style="color:#66d9ef">my</span> $slope <span style="color:#f92672">=</span> self<span style="color:#f92672">.</span>slope;
        <span style="color:#66d9ef">return</span> $<span style="color:#960050;background-color:#1e0010">.</span>start<span style="color:#f92672">.</span>y <span style="color:#f92672">-</span> $slope <span style="color:#f92672">*</span> $<span style="color:#960050;background-color:#1e0010">.</span>start<span style="color:#f92672">.</span>x;
    }
    method line<span style="color:#f92672">-</span>coordinates { <span style="color:#75715e"># used only for debugging purpose</span>
        <span style="color:#66d9ef">return</span> self<span style="color:#f92672">.</span>slope, self<span style="color:#f92672">.</span>y<span style="color:#f92672">-</span>intercept;
    }
}

<span style="color:#66d9ef">sub</span> <span style="color:#a6e22e">compute</span>-intersection (Segment $s1, Segment $s2) {
    <span style="color:#66d9ef">my</span> $abscissa <span style="color:#f92672">=</span> ($s2<span style="color:#f92672">.</span>y<span style="color:#f92672">-</span>intercept <span style="color:#f92672">-</span> $s1<span style="color:#f92672">.</span>y<span style="color:#f92672">-</span>intercept) <span style="color:#f92672">/</span>
                   ($s1<span style="color:#f92672">.</span>slope <span style="color:#f92672">-</span> $s2<span style="color:#f92672">.</span>slope);
    <span style="color:#66d9ef">my</span> $ordinate <span style="color:#f92672">=</span> $s1<span style="color:#f92672">.</span>slope <span style="color:#f92672">*</span> $abscissa <span style="color:#f92672">+</span> $s1<span style="color:#f92672">.</span>y<span style="color:#f92672">-</span>intercept;
    <span style="color:#66d9ef">my</span> $intersection <span style="color:#f92672">=</span> Point<span style="color:#f92672">.</span><span style="color:#66d9ef">new</span>( x <span style="color:#f92672">=&gt;</span> $abscissa, y <span style="color:#f92672">=&gt;</span> $ordinate);
}

multi MAIN ( $a1, $b1, <span style="color:#75715e"># start of line segment 1</span>
             $a2, $b2, <span style="color:#75715e"># end of line segment 1</span>
             $a3, $b3, <span style="color:#75715e"># start of line segment 2</span>
             $a4, $b4  <span style="color:#75715e"># end of line segment 2</span>
         ) {
    <span style="color:#66d9ef">my</span> $segment1 <span style="color:#f92672">=</span> Segment<span style="color:#f92672">.</span><span style="color:#66d9ef">new</span>(
                                 start <span style="color:#f92672">=&gt;</span> Point<span style="color:#f92672">.</span><span style="color:#66d9ef">new</span>(x <span style="color:#f92672">=&gt;</span> $a1, y <span style="color:#f92672">=&gt;</span> $b1),
                                 end   <span style="color:#f92672">=&gt;</span> Point<span style="color:#f92672">.</span><span style="color:#66d9ef">new</span>(x <span style="color:#f92672">=&gt;</span> $a2, y <span style="color:#f92672">=&gt;</span> $b2)
                              );
    <span style="color:#66d9ef">my</span> $segment2 <span style="color:#f92672">=</span> Segment<span style="color:#f92672">.</span><span style="color:#66d9ef">new</span>(
                                 start <span style="color:#f92672">=&gt;</span> Point<span style="color:#f92672">.</span><span style="color:#66d9ef">new</span>(x <span style="color:#f92672">=&gt;</span> $a3, y <span style="color:#f92672">=&gt;</span> $b3),
                                 end   <span style="color:#f92672">=&gt;</span> Point<span style="color:#f92672">.</span><span style="color:#66d9ef">new</span>(x <span style="color:#f92672">=&gt;</span> $a4, y <span style="color:#f92672">=&gt;</span> $b4)
                              );
    say <span style="color:#e6db74">&#34;Coordinates of intersection point: &#34;</span>, compute<span style="color:#f92672">-</span>intersection $segment1, $segment2;
}
multi MAIN () {
    say <span style="color:#e6db74">&#34;Using default input values for testing. Should display poinr (2, 4).&#34;</span>;
    <span style="color:#66d9ef">my</span> $segment1 <span style="color:#f92672">=</span> Segment<span style="color:#f92672">.</span><span style="color:#66d9ef">new</span>(
                                 start <span style="color:#f92672">=&gt;</span> Point<span style="color:#f92672">.</span><span style="color:#66d9ef">new</span>(x <span style="color:#f92672">=&gt;</span> <span style="color:#ae81ff">3</span>, y <span style="color:#f92672">=&gt;</span> <span style="color:#ae81ff">1</span>),
                                 end   <span style="color:#f92672">=&gt;</span> Point<span style="color:#f92672">.</span><span style="color:#66d9ef">new</span>(x <span style="color:#f92672">=&gt;</span> <span style="color:#ae81ff">5</span>, y <span style="color:#f92672">=&gt;</span> <span style="color:#ae81ff">3</span>)
                              );
    <span style="color:#66d9ef">my</span> $segment2 <span style="color:#f92672">=</span> Segment<span style="color:#f92672">.</span><span style="color:#66d9ef">new</span>(
                                 start <span style="color:#f92672">=&gt;</span> Point<span style="color:#f92672">.</span><span style="color:#66d9ef">new</span>(x <span style="color:#f92672">=&gt;</span> <span style="color:#ae81ff">3</span>, y <span style="color:#f92672">=&gt;</span> <span style="color:#ae81ff">3</span>),
                                 end   <span style="color:#f92672">=&gt;</span> Point<span style="color:#f92672">.</span><span style="color:#66d9ef">new</span>(x <span style="color:#f92672">=&gt;</span> <span style="color:#ae81ff">6</span>, y <span style="color:#f92672">=&gt;</span> <span style="color:#ae81ff">0</span>)
                              );
    say  <span style="color:#e6db74">&#34;Coordinates of intersection point: &#34;</span>, compute<span style="color:#f92672">-</span>intersection $segment1, $segment2;
}
</code></pre></div><p>This is a sample run of the program:</p>
<pre><code>$ perl6  intersection.p6  3 1 5 3 3 3 6 0
Coordinates of intersection point:
- Abscissa: 4
- Ordinate: 2.
</code></pre>
<p>As it is, this program isn&rsquo;t doing any validation on its arguments. So we will add a <code>valid-args</code> subroutine for that purpose and also check that the computed segments are not parallel.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-Perl6" data-lang="Perl6"><span style="color:#66d9ef">use</span> v6;

role Point {
    has $<span style="color:#960050;background-color:#1e0010">.</span>x;
    has $<span style="color:#960050;background-color:#1e0010">.</span>y;

    method gist {
        <span style="color:#66d9ef">return</span> <span style="color:#e6db74">&#34;\n- Abscissa: $.x\n- Ordinate: $.y.&#34;</span>;
    }
}
class Segment {
    has Point $<span style="color:#960050;background-color:#1e0010">.</span>start;
    has Point $<span style="color:#960050;background-color:#1e0010">.</span>end;

    method slope {
        <span style="color:#66d9ef">return</span> ($<span style="color:#960050;background-color:#1e0010">.</span>end<span style="color:#f92672">.</span>y <span style="color:#f92672">-</span> $<span style="color:#960050;background-color:#1e0010">.</span>start<span style="color:#f92672">.</span>y) <span style="color:#f92672">/</span> ($<span style="color:#960050;background-color:#1e0010">.</span>end<span style="color:#f92672">.</span>x <span style="color:#f92672">-</span> $<span style="color:#960050;background-color:#1e0010">.</span>start<span style="color:#f92672">.</span>x);
    }
    method y<span style="color:#f92672">-</span>intercept {
        <span style="color:#66d9ef">my</span> $slope <span style="color:#f92672">=</span> self<span style="color:#f92672">.</span>slope;
        <span style="color:#66d9ef">return</span> $<span style="color:#960050;background-color:#1e0010">.</span>start<span style="color:#f92672">.</span>y <span style="color:#f92672">-</span> $slope <span style="color:#f92672">*</span> $<span style="color:#960050;background-color:#1e0010">.</span>start<span style="color:#f92672">.</span>x;
    }
    method line<span style="color:#f92672">-</span>coordinates {
        <span style="color:#66d9ef">return</span> self<span style="color:#f92672">.</span>slope, self<span style="color:#f92672">.</span>y<span style="color:#f92672">-</span>intercept;
    }
}
<span style="color:#66d9ef">sub</span> <span style="color:#a6e22e">compute</span>-intersection (Segment $s1, Segment $s2) {
    <span style="color:#66d9ef">my</span> $abscissa <span style="color:#f92672">=</span> ($s2<span style="color:#f92672">.</span>y<span style="color:#f92672">-</span>intercept <span style="color:#f92672">-</span> $s1<span style="color:#f92672">.</span>y<span style="color:#f92672">-</span>intercept) <span style="color:#f92672">/</span>
                   ($s1<span style="color:#f92672">.</span>slope <span style="color:#f92672">-</span> $s2<span style="color:#f92672">.</span>slope);
    <span style="color:#66d9ef">my</span> $ordinate <span style="color:#f92672">=</span> $s1<span style="color:#f92672">.</span>slope <span style="color:#f92672">*</span> $abscissa <span style="color:#f92672">+</span> $s1<span style="color:#f92672">.</span>y<span style="color:#f92672">-</span>intercept;
    <span style="color:#66d9ef">my</span> $intersection <span style="color:#f92672">=</span> Point<span style="color:#f92672">.</span><span style="color:#66d9ef">new</span>( x <span style="color:#f92672">=&gt;</span> $abscissa, y <span style="color:#f92672">=&gt;</span> $ordinate);
}
multi MAIN ( $a1, $b1, <span style="color:#75715e"># start of line segment 1</span>
             $a2, $b2, <span style="color:#75715e"># end of line segment 1</span>
             $a3, $b3, <span style="color:#75715e"># start of line segment 2</span>
             $a4, $b4  <span style="color:#75715e"># end of line segment 2</span>
         ) {
    exit <span style="color:#66d9ef">unless</span> valid<span style="color:#f92672">-</span>args <span style="color:#f92672">|</span>@<span style="color:#960050;background-color:#1e0010">*</span>ARGS;
    <span style="color:#66d9ef">my</span> $segment1 <span style="color:#f92672">=</span> Segment<span style="color:#f92672">.</span><span style="color:#66d9ef">new</span>(
            start <span style="color:#f92672">=&gt;</span> Point<span style="color:#f92672">.</span><span style="color:#66d9ef">new</span>(x <span style="color:#f92672">=&gt;</span> $a1, y <span style="color:#f92672">=&gt;</span> $b1),
            end   <span style="color:#f92672">=&gt;</span> Point<span style="color:#f92672">.</span><span style="color:#66d9ef">new</span>(x <span style="color:#f92672">=&gt;</span> $a2, y <span style="color:#f92672">=&gt;</span> $b2)
                              );
    <span style="color:#66d9ef">my</span> $segment2 <span style="color:#f92672">=</span> Segment<span style="color:#f92672">.</span><span style="color:#66d9ef">new</span>(
            start <span style="color:#f92672">=&gt;</span> Point<span style="color:#f92672">.</span><span style="color:#66d9ef">new</span>(x <span style="color:#f92672">=&gt;</span> $a3, y <span style="color:#f92672">=&gt;</span> $b3),
            end   <span style="color:#f92672">=&gt;</span> Point<span style="color:#f92672">.</span><span style="color:#66d9ef">new</span>(x <span style="color:#f92672">=&gt;</span> $a4, y <span style="color:#f92672">=&gt;</span> $b4)
                              );
    say <span style="color:#e6db74">&#34;Segments are parallel or colinear.&#34;</span> <span style="color:#f92672">and</span> exit
        <span style="color:#66d9ef">if</span> $segment1<span style="color:#f92672">.</span>slope <span style="color:#f92672">==</span> $segment2<span style="color:#f92672">.</span>slope;
    say <span style="color:#e6db74">&#34;Coordinates of intersection point: &#34;</span>,
        compute<span style="color:#f92672">-</span>intersection $segment1, $segment2;
}
multi MAIN () {
    say <span style="color:#e6db74">&#34;Using default input values for testing. Should display poinr (2, 4).&#34;</span>;
    <span style="color:#66d9ef">my</span> $segment1 <span style="color:#f92672">=</span> Segment<span style="color:#f92672">.</span><span style="color:#66d9ef">new</span>(
            start <span style="color:#f92672">=&gt;</span> Point<span style="color:#f92672">.</span><span style="color:#66d9ef">new</span>(x <span style="color:#f92672">=&gt;</span> <span style="color:#ae81ff">3</span>, y <span style="color:#f92672">=&gt;</span> <span style="color:#ae81ff">1</span>),
            end   <span style="color:#f92672">=&gt;</span> Point<span style="color:#f92672">.</span><span style="color:#66d9ef">new</span>(x <span style="color:#f92672">=&gt;</span> <span style="color:#ae81ff">5</span>, y <span style="color:#f92672">=&gt;</span> <span style="color:#ae81ff">3</span>)
                              );
    <span style="color:#66d9ef">my</span> $segment2 <span style="color:#f92672">=</span> Segment<span style="color:#f92672">.</span><span style="color:#66d9ef">new</span>(
            start <span style="color:#f92672">=&gt;</span> Point<span style="color:#f92672">.</span><span style="color:#66d9ef">new</span>(x <span style="color:#f92672">=&gt;</span> <span style="color:#ae81ff">3</span>, y <span style="color:#f92672">=&gt;</span> <span style="color:#ae81ff">3</span>),
            end   <span style="color:#f92672">=&gt;</span> Point<span style="color:#f92672">.</span><span style="color:#66d9ef">new</span>(x <span style="color:#f92672">=&gt;</span> <span style="color:#ae81ff">6</span>, y <span style="color:#f92672">=&gt;</span> <span style="color:#ae81ff">0</span>)
                              );
    say  <span style="color:#e6db74">&#34;Coordinates of intersection point: &#34;</span>,
        compute<span style="color:#f92672">-</span>intersection $segment1, $segment2;
}
<span style="color:#66d9ef">sub</span> <span style="color:#a6e22e">valid</span>-args ( $a1, $b1, # start of line segment 1
                 $a2, $b2, # end of line segment 1
                 $a3, $b3, # start of line segment 2
                 $a4, $b4  # end of line segment 2
         ) {
    <span style="color:#66d9ef">unless</span> @<span style="color:#960050;background-color:#1e0010">*</span>ARGS<span style="color:#f92672">.</span>all <span style="color:#f92672">~~</span> <span style="color:#e6db74">/&lt;[\d]&gt;+/</span> {
        say <span style="color:#e6db74">&#34;Non numeric argument. Can&#39;t continue.&#34;</span>;
        <span style="color:#66d9ef">return</span> False;
    }
    <span style="color:#66d9ef">if</span> $a1 <span style="color:#f92672">==</span> $a2 <span style="color:#f92672">and</span> $b1 <span style="color:#f92672">==</span> $b2 {
        say <span style="color:#e6db74">&#34;The first two points are the same. Cannot draw a line.&#34;</span>;
        <span style="color:#66d9ef">return</span> False;
    }
    <span style="color:#66d9ef">if</span> $a3 <span style="color:#f92672">==</span> $a4 <span style="color:#f92672">and</span> $b3 <span style="color:#f92672">==</span> $b4 {
        say <span style="color:#e6db74">&#34;The last two points are the same. Cannot draw a line.&#34;</span>;
        <span style="color:#66d9ef">return</span> False;
    }
    <span style="color:#66d9ef">if</span> $a1 <span style="color:#f92672">==</span> $a2 <span style="color:#f92672">and</span> $a3 <span style="color:#f92672">==</span> $a4 {
        say <span style="color:#e6db74">&#34;The two segments are vertical. No intersection.&#34;</span>;
        <span style="color:#66d9ef">return</span> False;
    }
    <span style="color:#66d9ef">if</span> $a1 <span style="color:#f92672">==</span> $a2 {
        <span style="color:#75715e"># First segment is vertical but not the second one</span>
        <span style="color:#66d9ef">my</span> $segment2 <span style="color:#f92672">=</span> Segment<span style="color:#f92672">.</span><span style="color:#66d9ef">new</span>(
                start <span style="color:#f92672">=&gt;</span> Point<span style="color:#f92672">.</span><span style="color:#66d9ef">new</span>(x <span style="color:#f92672">=&gt;</span> $a3, y <span style="color:#f92672">=&gt;</span> $b3),
                end   <span style="color:#f92672">=&gt;</span> Point<span style="color:#f92672">.</span><span style="color:#66d9ef">new</span>(x <span style="color:#f92672">=&gt;</span> $a4, y <span style="color:#f92672">=&gt;</span> $b4)
            );
        <span style="color:#66d9ef">my</span> $ordinate <span style="color:#f92672">=</span> $segment2<span style="color:#f92672">.</span>slope <span style="color:#f92672">*</span> $a1 <span style="color:#f92672">+</span> $segment2<span style="color:#f92672">.</span>y<span style="color:#f92672">-</span>intercept;
        <span style="color:#66d9ef">my</span> $interception <span style="color:#f92672">=</span> Point<span style="color:#f92672">.</span><span style="color:#66d9ef">new</span>(x <span style="color:#f92672">=&gt;</span> $a1, y <span style="color:#f92672">=&gt;</span> $ordinate);
        say <span style="color:#e6db74">&#34;Coordinates of intersection point: &#34;</span>, $interception;
        <span style="color:#66d9ef">return</span> False;
    }
    <span style="color:#66d9ef">if</span> $a3 <span style="color:#f92672">==</span> $a4 {
        <span style="color:#75715e"># Second segment is vertical but not the first one</span>
        <span style="color:#66d9ef">my</span> $segment1 <span style="color:#f92672">=</span> Segment<span style="color:#f92672">.</span><span style="color:#66d9ef">new</span>(
                start <span style="color:#f92672">=&gt;</span> Point<span style="color:#f92672">.</span><span style="color:#66d9ef">new</span>(x <span style="color:#f92672">=&gt;</span> $a1, y <span style="color:#f92672">=&gt;</span> $b1),
                end   <span style="color:#f92672">=&gt;</span> Point<span style="color:#f92672">.</span><span style="color:#66d9ef">new</span>(x <span style="color:#f92672">=&gt;</span> $a2, y <span style="color:#f92672">=&gt;</span> $b2)
            );
        <span style="color:#66d9ef">my</span> $ordinate <span style="color:#f92672">=</span> $segment1<span style="color:#f92672">.</span>slope <span style="color:#f92672">*</span> $a3 <span style="color:#f92672">+</span> $segment1<span style="color:#f92672">.</span>y<span style="color:#f92672">-</span>intercept;
        <span style="color:#66d9ef">my</span> $interception <span style="color:#f92672">=</span> Point<span style="color:#f92672">.</span><span style="color:#66d9ef">new</span>(x <span style="color:#f92672">=&gt;</span> $a3, y <span style="color:#f92672">=&gt;</span> $ordinate);
        say <span style="color:#e6db74">&#34;Coordinates of intersection point: &#34;</span>, $interception;
        <span style="color:#66d9ef">return</span> False;
    }
    <span style="color:#66d9ef">return</span> True;
}
</code></pre></div><p>Running the program with some examples of valid or invalid arguments displays the following:</p>
<pre><code>$ perl6  intersection.p6  3 1 5 3 3 3 n 0
Non numeric argument. Can't continue.

$ perl6  intersection.p6  3 1 5 3 3 3 5.4 0
Coordinates of intersection point:
- Abscissa: 3.888889
- Ordinate: 1.888889.

$ perl6  intersection.p6  3 1 5 3 3 3 6.0 0
Coordinates of intersection point:
- Abscissa: 4
- Ordinate: 2.

$ perl6  intersection.p6  3 1 5 3 6 2 10 6
Segments are parallel or colinear.

$ perl6  intersection.p6  3 1 3 1 3 3 6 0
The first two points are the same. Cannot draw a line.

$ perl6  intersection.p6  3 1 3 2 3 5 3 0
The two segments are vertical. Cannot find an intersection.
</code></pre>
<h2 id="alternate-solutions">Alternate Solutions</h2>
<p>My program just above is much longer than most other solutions presented below. The only other quite long program is Joelle Maslak&rsquo;s, which also happens to be the only other object-oriented solution. This may be a coincidence, but I have the feeling that OO programming often leads to rather verbose solutions. And this is, by the way, one of the reasons why I&rsquo;m not a great fan of OO programming: it feels a bit like writing Java in Perl 6. Having said that, I should add that most more concise solutions contain long mathematical formulas that are a bit difficult to read and hardly self-documenting.</p>
<p><a href="https://github.com/manwar/perlweeklychallenge-club/blob/master/challenge-027/arne-sommer/perl6/ch-1.p6">Arne Sommer</a>&lsquo;s solution is much shorter than mine, but I&rsquo;m afraid Arne looked only at some of the edge cases:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-Perl6" data-lang="Perl6"><span style="color:#66d9ef">my</span> <span style="color:#f92672">\</span>ta1 <span style="color:#f92672">=</span> (y3<span style="color:#960050;background-color:#1e0010">−</span>y4) <span style="color:#f92672">*</span> (x1<span style="color:#960050;background-color:#1e0010">−</span>x3) <span style="color:#f92672">+</span> (x4<span style="color:#960050;background-color:#1e0010">−</span>x3) <span style="color:#f92672">*</span> (y1<span style="color:#960050;background-color:#1e0010">−</span>y3);
<span style="color:#66d9ef">my</span> <span style="color:#f92672">\</span>ta2 <span style="color:#f92672">=</span> (x4<span style="color:#960050;background-color:#1e0010">−</span>x3) <span style="color:#f92672">*</span> (y1<span style="color:#960050;background-color:#1e0010">−</span>y2) <span style="color:#960050;background-color:#1e0010">−</span> (x1<span style="color:#960050;background-color:#1e0010">−</span>x2) <span style="color:#f92672">*</span> (y4<span style="color:#960050;background-color:#1e0010">−</span>y3);
<span style="color:#66d9ef">my</span> <span style="color:#f92672">\</span>tb1 <span style="color:#f92672">=</span> (y1<span style="color:#960050;background-color:#1e0010">−</span>y2) <span style="color:#f92672">*</span> (x1<span style="color:#960050;background-color:#1e0010">−</span>x3) <span style="color:#f92672">+</span> (x2<span style="color:#960050;background-color:#1e0010">−</span>x1) <span style="color:#f92672">*</span> (y1<span style="color:#960050;background-color:#1e0010">−</span>y3);
<span style="color:#66d9ef">my</span> <span style="color:#f92672">\</span>tb2 <span style="color:#f92672">=</span> (x4<span style="color:#960050;background-color:#1e0010">−</span>x3) <span style="color:#f92672">*</span> (y1<span style="color:#960050;background-color:#1e0010">−</span>y2) <span style="color:#960050;background-color:#1e0010">−</span> (x1<span style="color:#960050;background-color:#1e0010">−</span>x2) <span style="color:#f92672">*</span> (y4<span style="color:#960050;background-color:#1e0010">−</span>y3);
<span style="color:#66d9ef">my</span> <span style="color:#f92672">\</span>ta <span style="color:#f92672">=</span> ta1 <span style="color:#f92672">/</span> ta2;
<span style="color:#66d9ef">my</span> <span style="color:#f92672">\</span>tb <span style="color:#f92672">=</span> tb1 <span style="color:#f92672">/</span> tb2;
<span style="color:#66d9ef">if</span> ta2 <span style="color:#f92672">==</span> <span style="color:#ae81ff">0</span> <span style="color:#f92672">||</span> tb2 <span style="color:#f92672">==</span> <span style="color:#ae81ff">0</span>
{
  say <span style="color:#e6db74">&#34;Colinear lines&#34;</span>;
}
<span style="color:#66d9ef">elsif</span> <span style="color:#ae81ff">0</span> <span style="color:#f92672">&lt;=</span> ta <span style="color:#f92672">&lt;=</span> <span style="color:#ae81ff">1</span> <span style="color:#f92672">&amp;&amp;</span> <span style="color:#ae81ff">0</span> <span style="color:#f92672">&lt;=</span> tb <span style="color:#f92672">&lt;=</span> <span style="color:#ae81ff">1</span>
{
  say <span style="color:#e6db74">&#34;Segment intersection at x: { x1 + ta * (x2 - x1) } y: { y1 + ta * (y2 − y1) }&#34;</span>;
}
<span style="color:#66d9ef">else</span>
{
  say <span style="color:#e6db74">&#34;General Intersection (outside the box)&#34;</span>;
}
</code></pre></div><p><a href="https://github.com/manwar/perlweeklychallenge-club/blob/master/challenge-027/kevin-colyer/perl6/ch-1.p6">Kevin Colyer</a>&lsquo;s solution is also shorter than mine but also appears to skip some of the validation. This is the code of Kevin&rsquo;s subroutine making the real work:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-Perl6" data-lang="Perl6"><span style="color:#66d9ef">sub</span> <span style="color:#a6e22e">intersection</span>($a,$b,$c,$d,$e,$f,$g,$h) {
    <span style="color:#66d9ef">my</span> $m1<span style="color:#f92672">=</span>($b<span style="color:#f92672">-</span>$d)<span style="color:#f92672">/</span>($a<span style="color:#f92672">-</span>$c);
    <span style="color:#66d9ef">my</span> $m2<span style="color:#f92672">=</span>($f<span style="color:#f92672">-</span>$h)<span style="color:#f92672">/</span>($e<span style="color:#f92672">-</span>$g);

    <span style="color:#66d9ef">return</span> (False,Nil,Nil,<span style="color:#e6db74">&#34;Do not intersect: lines are parallel&#34;</span>) <span style="color:#66d9ef">if</span> $m1<span style="color:#f92672">==</span>$m2;

    <span style="color:#66d9ef">my</span> $x<span style="color:#f92672">=</span>($f<span style="color:#f92672">-</span>$b<span style="color:#f92672">+</span>$m1<span style="color:#f92672">*</span>$a<span style="color:#f92672">-</span>$m2<span style="color:#f92672">*</span>$e)<span style="color:#f92672">/</span>($m1<span style="color:#f92672">-</span>$m2);

    <span style="color:#66d9ef">my</span> $y<span style="color:#f92672">=</span>$m2<span style="color:#f92672">*</span>$x<span style="color:#f92672">-</span>$m2<span style="color:#f92672">*</span>$e<span style="color:#f92672">+</span>$f;

    <span style="color:#66d9ef">return</span> (False,Nil,Nil,<span style="color:#e6db74">&#34;Do not intersect: x is not on line 1&#34;</span>) <span style="color:#66d9ef">if</span> $x <span style="color:#f92672">&lt;</span> $a <span style="color:#f92672">&lt;</span> $c <span style="color:#f92672">or</span> $x <span style="color:#f92672">&gt;</span> $c <span style="color:#f92672">&gt;</span> $a;
    <span style="color:#66d9ef">return</span> (False,Nil,Nil,<span style="color:#e6db74">&#34;Do not intersect: y is not on line 1&#34;</span>) <span style="color:#66d9ef">if</span> $y <span style="color:#f92672">&lt;</span> $b <span style="color:#f92672">&lt;</span> $d <span style="color:#f92672">or</span> $y <span style="color:#f92672">&gt;</span> $d <span style="color:#f92672">&gt;</span> $b;
    <span style="color:#66d9ef">return</span> (False,Nil,Nil,<span style="color:#e6db74">&#34;Do not intersect: x is not on line 2&#34;</span>) <span style="color:#66d9ef">if</span> $x <span style="color:#f92672">&lt;</span> $e <span style="color:#f92672">&lt;</span> $g <span style="color:#f92672">or</span> $x <span style="color:#f92672">&gt;</span> $g <span style="color:#f92672">&gt;</span> $e;
    <span style="color:#66d9ef">return</span> (False,Nil,Nil,<span style="color:#e6db74">&#34;Do not intersect: y is not on line 2&#34;</span>) <span style="color:#66d9ef">if</span> $y <span style="color:#f92672">&lt;</span> $f <span style="color:#f92672">&lt;</span> $h <span style="color:#f92672">or</span> $y <span style="color:#f92672">&gt;</span> $h <span style="color:#f92672">&gt;</span> $f;

    <span style="color:#66d9ef">return</span> (True,$x,$y,<span style="color:#e6db74">&#34;Lines intersect at $x,$y&#34;</span>);
}
</code></pre></div><p><a href="https://github.com/manwar/perlweeklychallenge-club/blob/master/challenge-027/markus-holzer/perl6/ch-1.p6">Markus Holzer</a> also made a very short solution. This is Markus&rsquo;s main subroutine:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-Perl6" data-lang="Perl6"><span style="color:#66d9ef">sub</span> <span style="color:#a6e22e">intersection</span>( Int \x1, Int \y1, Int \x2, Int \y2, Int \x3, Int \y3, Int \x4, Int \y4 )
{
    CATCH { default { fail <span style="color:#e6db74">&#34;Lines are parallel or identical&#34;</span> } }

    <span style="color:#66d9ef">return</span> (
        eager <span style="color:#75715e"># potential for division by zero,</span>
            ( (x1 <span style="color:#f92672">*</span> y2 <span style="color:#f92672">-</span> y1 <span style="color:#f92672">*</span> x2 ) <span style="color:#f92672">*</span> (x3 <span style="color:#f92672">-</span> x4) <span style="color:#f92672">-</span> (x1 <span style="color:#f92672">-</span> x2) <span style="color:#f92672">*</span> (x3 <span style="color:#f92672">*</span> y4 <span style="color:#f92672">-</span> y3<span style="color:#f92672">*</span>x4) ) div
            ( (x1 <span style="color:#f92672">-</span> x2) <span style="color:#f92672">*</span> (y3 <span style="color:#f92672">-</span> y4) <span style="color:#f92672">-</span> (y1 <span style="color:#f92672">-</span> y2) <span style="color:#f92672">*</span> (x3 <span style="color:#f92672">-</span> x4) ),

        eager <span style="color:#75715e"># without eager, laziness will bite us later</span>
            ( (x1 <span style="color:#f92672">*</span> y2 <span style="color:#f92672">-</span> y1 <span style="color:#f92672">*</span> x2) <span style="color:#f92672">*</span> (y3 <span style="color:#f92672">-</span> y4) <span style="color:#f92672">-</span> (y1 <span style="color:#f92672">-</span>y2) <span style="color:#f92672">*</span> (x3<span style="color:#f92672">*</span>y4 <span style="color:#f92672">-</span> y3 <span style="color:#f92672">*</span> x4) ) div
            ( (x1 <span style="color:#f92672">-</span> x2) <span style="color:#f92672">*</span> (y3 <span style="color:#f92672">-</span> y4) <span style="color:#f92672">-</span> (y1 <span style="color:#f92672">-</span> y2) <span style="color:#f92672">*</span> (x2 <span style="color:#f92672">-</span> x4) )
    );
}
</code></pre></div><p><a href="https://github.com/manwar/perlweeklychallenge-club/blob/master/challenge-027/noud/perl6/ch-1.p6">Noud</a> has the following very relevant comment:</p>
<pre><code># Computational geometry is always difficult, because there are so many border
# cases you have to take into account. I hope I covered all of them.
</code></pre>
<p>Noud&rsquo;s main subroutine is as follows:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-Perl6" data-lang="Perl6"><span style="color:#66d9ef">sub</span> <span style="color:#a6e22e">line_intersection</span>(($x1, $y1), ($x2, $y2), ($x3, $y3), ($x4, $y4)) {
    <span style="color:#66d9ef">if</span> (($x1 <span style="color:#f92672">==</span> $x2 <span style="color:#f92672">and</span> $y1 <span style="color:#f92672">==</span> $y2) <span style="color:#f92672">or</span> ($x3 <span style="color:#f92672">==</span> $x4 <span style="color:#f92672">and</span> $y3 <span style="color:#f92672">==</span> $y4)) {
        die <span style="color:#e6db74">&#34;Input doesn&#39;t represent two lines.&#34;</span>;
    }
    <span style="color:#66d9ef">my</span> $disc <span style="color:#f92672">=</span> ($x1 <span style="color:#f92672">-</span> $x2) <span style="color:#f92672">*</span> ($y3 <span style="color:#f92672">-</span> $y4) <span style="color:#f92672">-</span> ($y1 <span style="color:#f92672">-</span> $y2) <span style="color:#f92672">*</span> ($x3 <span style="color:#f92672">-</span> $x4);
    <span style="color:#66d9ef">if</span> ($disc <span style="color:#f92672">==</span> <span style="color:#ae81ff">0</span>) {
        <span style="color:#66d9ef">if</span> ($x1 <span style="color:#f92672">==</span> $x2 <span style="color:#f92672">and</span> $x2 <span style="color:#f92672">==</span> $x3 <span style="color:#f92672">and</span> $x3 <span style="color:#f92672">==</span> $x4) {
            <span style="color:#75715e"># Lines coincide vertically. Return one coinciding point.</span>
            <span style="color:#66d9ef">return</span> ($x1, $y1);
        }
        <span style="color:#66d9ef">if</span> ($y1 <span style="color:#f92672">==</span> $y2 <span style="color:#f92672">and</span> $y2 <span style="color:#f92672">==</span> $y3 <span style="color:#f92672">and</span> $y3 <span style="color:#f92672">==</span> $y4) {
            <span style="color:#75715e"># Lines coincide horizontally. Return one coinciding point.</span>
            <span style="color:#66d9ef">return</span> ($x1, $y1);
        }
        <span style="color:#66d9ef">if</span> (($y1 <span style="color:#f92672">-</span> $x1) <span style="color:#f92672">*</span> ($x4 <span style="color:#f92672">-</span> $x2) <span style="color:#f92672">==</span> ($y2 <span style="color:#f92672">-</span> $x2) <span style="color:#f92672">*</span> ($x3 <span style="color:#f92672">-</span> $x1)) {
            <span style="color:#75715e"># Lines coincide diagonally. Return one coinciding point.</span>
            <span style="color:#66d9ef">return</span> ($x1, $y1);
        }
        <span style="color:#75715e"># If the discriminant is zero, the two lines are parallel to each</span>
        <span style="color:#75715e"># other. Therefore, depending on your definitions the lines don&#39;t</span>
        <span style="color:#75715e"># intersect, or they intersect at infinity, introducing a</span>
        <span style="color:#75715e"># non-Euclidian geometry. I choose the latter.</span>
        <span style="color:#66d9ef">return</span> Inf;
    }
    <span style="color:#75715e"># Discriminant is non-zero, hence there is one intersecting point.</span>
    <span style="color:#66d9ef">return</span> ((($x1 <span style="color:#f92672">*</span> $y2 <span style="color:#f92672">-</span> $y1 <span style="color:#f92672">*</span> $x2) <span style="color:#f92672">*</span> ($x3 <span style="color:#f92672">-</span> $x4)
            <span style="color:#f92672">-</span> ($x3 <span style="color:#f92672">*</span> $y4 <span style="color:#f92672">-</span> $y3 <span style="color:#f92672">*</span> $x4) <span style="color:#f92672">*</span> ($x1 <span style="color:#f92672">-</span> $x2)) <span style="color:#f92672">/</span> $disc,
        (($x1 <span style="color:#f92672">*</span> $y2 <span style="color:#f92672">-</span> $y1 <span style="color:#f92672">*</span> $x2) <span style="color:#f92672">*</span> ($y3 <span style="color:#f92672">-</span> $y4)
            <span style="color:#f92672">-</span> ($x3 <span style="color:#f92672">*</span> $y4 <span style="color:#f92672">-</span> $y3 <span style="color:#f92672">*</span> $x4) <span style="color:#f92672">*</span> ($y1 <span style="color:#f92672">-</span> $y2)) <span style="color:#f92672">/</span> $disc);
}
</code></pre></div><p><a href="https://github.com/manwar/perlweeklychallenge-club/blob/master/challenge-027/simon-proctor/perl6/ch-1.p6">Simon Proctor</a>&lsquo;s program is also fairly short:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-Perl6" data-lang="Perl6"><span style="color:#66d9ef">sub</span> <span style="color:#a6e22e">MAIN</span>( Rat() \a, Rat() \b, Rat() \c, Rat() \d,
          Rat() \p, Rat() \q, Rat() \r, Rat() \s ) {

    <span style="color:#66d9ef">my</span> <span style="color:#f92672">\</span>a1 <span style="color:#f92672">=</span> d <span style="color:#f92672">-</span> b;
    <span style="color:#66d9ef">my</span> <span style="color:#f92672">\</span>b1 <span style="color:#f92672">=</span> a <span style="color:#f92672">-</span> c;
    <span style="color:#66d9ef">my</span> <span style="color:#f92672">\</span>c1 <span style="color:#f92672">=</span> a1<span style="color:#f92672">*</span>(a) <span style="color:#f92672">+</span> b1<span style="color:#f92672">*</span>(b);

    <span style="color:#66d9ef">my</span> <span style="color:#f92672">\</span>a2 <span style="color:#f92672">=</span> s <span style="color:#f92672">-</span> <span style="color:#e6db74">q;
</span><span style="color:#e6db74">    my \b2 = p - r;</span>
    <span style="color:#66d9ef">my</span> <span style="color:#f92672">\</span>c2 <span style="color:#f92672">=</span> a2<span style="color:#f92672">*</span>(p)<span style="color:#f92672">+</span> b2<span style="color:#f92672">*</span>(<span style="color:#e6db74">q);
</span><span style="color:#e6db74">
</span><span style="color:#e6db74">    my \determinant = a1*b2 - a2*b1;
</span><span style="color:#e6db74">
</span><span style="color:#e6db74">    say &#34;Lines ({a},{b})</span> <span style="color:#f92672">-&gt;</span> ({c},{d}) <span style="color:#f92672">and</span> ({p},{<span style="color:#e6db74">q}) -&gt; ({r}</span>,{s})<span style="color:#e6db74">&#34;;
</span><span style="color:#e6db74">
</span><span style="color:#e6db74">    if ( determinant == 0 ) {
</span><span style="color:#e6db74">        say &#34;</span>Lines are parallel<span style="color:#f92672">.</span> No intersection<span style="color:#e6db74">&#34;;
</span><span style="color:#e6db74">    } else {
</span><span style="color:#e6db74">        my \x = (b2*c1 - b1*c2)/determinant;
</span><span style="color:#e6db74">        my \y = (a1*c2 - a2*c1)/determinant;
</span><span style="color:#e6db74">        say &#34;</span>Intersection at ({x},{y})<span style="color:#960050;background-color:#1e0010">&#34;</span>;
    }
}
</code></pre></div><p><a href="https://github.com/manwar/perlweeklychallenge-club/blob/master/challenge-027/joelle-maslak/perl6/ch-1.p6">Joelle Maslak</a>&lsquo;s code starts with a very interesting and detailed comment about all the edge cases. Well worth reading. Her program is object-oriented and defines a <code>Point</code> and a <code>Line</code> classes (both use the CPAN <code>StrictClass</code> role, which I did not know before and which makes the program choke on unknown attributes). Her <code>Line</code> class defines five methods and also redefines the <code>eqv</code> infix operator for <code>Line</code> objects:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-Perl6" data-lang="Perl6"><span style="color:#75715e"># We need an eqv that works</span>
CORE::<span style="color:#e6db74">&lt;&amp;infix:&lt;eqv&gt;</span><span style="color:#f92672">&gt;.</span>add_dispatchee(
    multi <span style="color:#66d9ef">sub</span> <span style="color:#a6e22e">infix</span>:&lt;eqv&gt; (Line:D $line1, Line:D $line2 --&gt;Bool) {
        <span style="color:#66d9ef">return</span> False <span style="color:#66d9ef">if</span> $line1<span style="color:#f92672">.</span>slope <span style="color:#960050;background-color:#1e0010">≠</span> $line2<span style="color:#f92672">.</span>slope;

        <span style="color:#75715e"># Are both vertical?</span>
        <span style="color:#66d9ef">if</span> $line1<span style="color:#f92672">.</span>slope <span style="color:#f92672">==</span> <span style="color:#960050;background-color:#1e0010">∞</span> <span style="color:#f92672">and</span> $line2<span style="color:#f92672">.</span>slope <span style="color:#f92672">==</span> <span style="color:#960050;background-color:#1e0010">∞</span> {
            <span style="color:#66d9ef">return</span> $line1<span style="color:#f92672">.</span>point<span style="color:#f92672">.</span>x <span style="color:#f92672">==</span> $line2<span style="color:#f92672">.</span>point<span style="color:#f92672">.</span>x;
        }

        <span style="color:#75715e"># All other lines</span>
        <span style="color:#66d9ef">return</span> $line1<span style="color:#f92672">.</span>point<span style="color:#f92672">.</span>y <span style="color:#f92672">==</span> $line2<span style="color:#f92672">.</span>solve<span style="color:#f92672">-</span><span style="color:#66d9ef">for</span><span style="color:#f92672">-</span>y($line1<span style="color:#f92672">.</span>point<span style="color:#f92672">.</span>x);
    }
);
</code></pre></div><p><a href="https://github.com/manwar/perlweeklychallenge-club/blob/master/challenge-027/roger-bell-west/perl6/ch-1.p6">Roger Bell West</a> contributed a fairly concise program (except for his rather verbose way of retrieving the argupments passed to the program):</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-Perl6" data-lang="Perl6"><span style="color:#66d9ef">my</span> @x;
<span style="color:#66d9ef">my</span> @y;

@x[<span style="color:#ae81ff">1</span>]<span style="color:#f92672">=</span>shift @<span style="color:#960050;background-color:#1e0010">*</span>ARGS;
@y[<span style="color:#ae81ff">1</span>]<span style="color:#f92672">=</span>shift @<span style="color:#960050;background-color:#1e0010">*</span>ARGS;
@x[<span style="color:#ae81ff">2</span>]<span style="color:#f92672">=</span>shift @<span style="color:#960050;background-color:#1e0010">*</span>ARGS;
@y[<span style="color:#ae81ff">2</span>]<span style="color:#f92672">=</span>shift @<span style="color:#960050;background-color:#1e0010">*</span>ARGS;
@x[<span style="color:#ae81ff">3</span>]<span style="color:#f92672">=</span>shift @<span style="color:#960050;background-color:#1e0010">*</span>ARGS;
@y[<span style="color:#ae81ff">3</span>]<span style="color:#f92672">=</span>shift @<span style="color:#960050;background-color:#1e0010">*</span>ARGS;
@x[<span style="color:#ae81ff">4</span>]<span style="color:#f92672">=</span>shift @<span style="color:#960050;background-color:#1e0010">*</span>ARGS;
@y[<span style="color:#ae81ff">4</span>]<span style="color:#f92672">=</span>shift @<span style="color:#960050;background-color:#1e0010">*</span>ARGS;

<span style="color:#66d9ef">my</span> $d<span style="color:#f92672">=</span>(@x[<span style="color:#ae81ff">1</span>]<span style="color:#f92672">-</span>@x[<span style="color:#ae81ff">2</span>])<span style="color:#f92672">*</span>(@y[<span style="color:#ae81ff">3</span>]<span style="color:#f92672">-</span>@y[<span style="color:#ae81ff">4</span>]) <span style="color:#f92672">-</span> (@y[<span style="color:#ae81ff">1</span>]<span style="color:#f92672">-</span>@y[<span style="color:#ae81ff">2</span>])<span style="color:#f92672">*</span>(@x[<span style="color:#ae81ff">3</span>]<span style="color:#f92672">-</span>@x[<span style="color:#ae81ff">4</span>]);
<span style="color:#66d9ef">if</span> ($d<span style="color:#f92672">==</span><span style="color:#ae81ff">0</span>) {
  die <span style="color:#e6db74">&#34;Lines are parallel or coincident.\n&#34;</span>;
}
<span style="color:#66d9ef">my</span> $t<span style="color:#f92672">=</span>( (@x[<span style="color:#ae81ff">1</span>]<span style="color:#f92672">-</span>@x[<span style="color:#ae81ff">3</span>])<span style="color:#f92672">*</span>(@y[<span style="color:#ae81ff">3</span>]<span style="color:#f92672">-</span>@y[<span style="color:#ae81ff">4</span>]) <span style="color:#f92672">-</span> (@y[<span style="color:#ae81ff">1</span>]<span style="color:#f92672">-</span>@y[<span style="color:#ae81ff">3</span>])<span style="color:#f92672">*</span>(@x[<span style="color:#ae81ff">3</span>]<span style="color:#f92672">-</span>@x[<span style="color:#ae81ff">4</span>]) )<span style="color:#f92672">/</span>$d;
<span style="color:#66d9ef">if</span> $t <span style="color:#f92672">&lt;</span> <span style="color:#ae81ff">0</span> <span style="color:#f92672">or</span> $t <span style="color:#f92672">&gt;</span> <span style="color:#ae81ff">1</span> {
  die <span style="color:#e6db74">&#34;No intersection.\n&#34;</span>;
}
<span style="color:#66d9ef">my</span> $u<span style="color:#f92672">=</span>( (@y[<span style="color:#ae81ff">1</span>]<span style="color:#f92672">-</span>@y[<span style="color:#ae81ff">2</span>])<span style="color:#f92672">*</span>(@x[<span style="color:#ae81ff">1</span>]<span style="color:#f92672">-</span>@x[<span style="color:#ae81ff">3</span>]) <span style="color:#f92672">-</span>  (@x[<span style="color:#ae81ff">1</span>]<span style="color:#f92672">-</span>@x[<span style="color:#ae81ff">2</span>])<span style="color:#f92672">*</span>(@y[<span style="color:#ae81ff">1</span>]<span style="color:#f92672">-</span>@y[<span style="color:#ae81ff">3</span>]))<span style="color:#f92672">/</span>$d;
<span style="color:#66d9ef">if</span> $u <span style="color:#f92672">&lt;</span> <span style="color:#ae81ff">0</span> <span style="color:#f92672">or</span> $u <span style="color:#f92672">&gt;</span> <span style="color:#ae81ff">1</span> {
  die <span style="color:#e6db74">&#34;No intersection.\n&#34;</span>;
}
@x[<span style="color:#ae81ff">0</span>]<span style="color:#f92672">=</span>@x[<span style="color:#ae81ff">1</span>]<span style="color:#f92672">+</span>$t<span style="color:#f92672">*</span>(@x[<span style="color:#ae81ff">2</span>]<span style="color:#f92672">-</span>@x[<span style="color:#ae81ff">1</span>]);
@y[<span style="color:#ae81ff">0</span>]<span style="color:#f92672">=</span>@y[<span style="color:#ae81ff">1</span>]<span style="color:#f92672">+</span>$t<span style="color:#f92672">*</span>(@y[<span style="color:#ae81ff">2</span>]<span style="color:#f92672">-</span>@y[<span style="color:#ae81ff">1</span>]);
say <span style="color:#e6db74">&#34;@x[0] @y[0]&#34;</span>;
</code></pre></div><p><a href="https://github.com/manwar/perlweeklychallenge-club/blob/master/challenge-027/ruben-westerberg/perl6/ch-1.p6">Ruben Westerberg</a> also suggested a very concise program:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-Perl6" data-lang="Perl6"><span style="color:#66d9ef">my</span> @l;
<span style="color:#66d9ef">while</span> @l <span style="color:#f92672">&lt;</span> <span style="color:#ae81ff">2</span>  {
    <span style="color:#66d9ef">my</span> @p<span style="color:#f92672">=</span>split <span style="color:#e6db74">&#34; &#34;</span>, prompt(<span style="color:#e6db74">&#34;Enter line&#34;</span><span style="color:#f92672">~</span>(@l<span style="color:#f92672">+</span><span style="color:#ae81ff">1</span>)<span style="color:#f92672">~</span><span style="color:#e6db74">&#34;:  x1 y1 x2 y2\n&#34;</span>), :skip<span style="color:#f92672">-</span>empty;
    <span style="color:#66d9ef">if</span> (@p<span style="color:#f92672">==</span><span style="color:#ae81ff">4</span>) {
        push @l, {px<span style="color:#f92672">=&gt;</span>[@p[<span style="color:#ae81ff">0</span>,<span style="color:#ae81ff">2</span>]],py<span style="color:#f92672">=&gt;</span>[@p[<span style="color:#ae81ff">1</span>,<span style="color:#ae81ff">3</span>]],m<span style="color:#f92672">=&gt;</span>Any,c<span style="color:#f92672">=&gt;</span>Any};
    }
    <span style="color:#66d9ef">else</span> {
        <span style="color:#66d9ef">print</span> <span style="color:#e6db74">&#34;not a valid line! \n&#34;</span>;
    }
}

<span style="color:#66d9ef">for</span> @l {
    $_<span style="color:#e6db74">&lt;m&gt;</span><span style="color:#f92672">=</span>($_<span style="color:#e6db74">&lt;py&gt;</span>[<span style="color:#ae81ff">1</span>]<span style="color:#f92672">-</span>$_<span style="color:#e6db74">&lt;py&gt;</span>[<span style="color:#ae81ff">0</span>])<span style="color:#f92672">/</span>($_<span style="color:#e6db74">&lt;px&gt;</span>[<span style="color:#ae81ff">1</span>]<span style="color:#f92672">-</span>$_<span style="color:#e6db74">&lt;px&gt;</span>[<span style="color:#ae81ff">0</span>]);
    $_<span style="color:#e6db74">&lt;c&gt;</span><span style="color:#f92672">=</span>$_<span style="color:#e6db74">&lt;py&gt;</span>[<span style="color:#ae81ff">0</span>]<span style="color:#f92672">-</span> ($_<span style="color:#e6db74">&lt;m&gt;</span><span style="color:#f92672">*</span>$_<span style="color:#e6db74">&lt;px&gt;</span>[<span style="color:#ae81ff">0</span>]);
}
<span style="color:#66d9ef">my</span> $x<span style="color:#f92672">=</span>(@l[<span style="color:#ae81ff">0</span>]<span style="color:#e6db74">&lt;c&gt;</span><span style="color:#f92672">-</span>@l[<span style="color:#ae81ff">1</span>]<span style="color:#e6db74">&lt;c&gt;</span>)<span style="color:#f92672">/</span>( @l[<span style="color:#ae81ff">1</span>]<span style="color:#e6db74">&lt;m&gt;</span><span style="color:#f92672">-</span>@l[<span style="color:#ae81ff">0</span>]<span style="color:#e6db74">&lt;m&gt;</span>);
<span style="color:#66d9ef">my</span> $y<span style="color:#f92672">=</span>@l[<span style="color:#ae81ff">0</span>]<span style="color:#e6db74">&lt;m&gt;</span><span style="color:#f92672">*</span>$x<span style="color:#f92672">+</span>@l[<span style="color:#ae81ff">0</span>]<span style="color:#e6db74">&lt;c&gt;</span>;

put <span style="color:#e6db74">&#34;Intercept point: $x, $y&#34;</span>;
</code></pre></div><hr>
<h1 id="task-2-displaying-historical-values">Task #2: Displaying Historical Values</h1>
<hr>
<p>This is derived in part from my <a href="http://blogs.perl.org/users/laurent_r/2019/09/perl-weekly-challenge-27-intersection-point-and-historical-values.html">blog post</a> made in answer to the <a href="https://perlweeklychallenge.org/blog/perl-weekly-challenge-027/">Week 27 of the Perl Weekly Challenge</a> organized by  <a href="http://blogs.perl.org/users/mohammad_s_anwar/">Mohammad S. Anwar</a> as well as answers made by others to the same challenge.</p>
<p>The challenge reads as follows:</p>
<p><em>Write a script that allows you to capture/display historical data. It could be an object or a scalar. For example:</em></p>
<blockquote>
<p><em>my $x = 10; $x = 20; $x -= 5;</em></p>
</blockquote>
<p><em>After the above operations, it should list $x historical value in order.</em></p>
<h2 id="my-solution-1">My Solution</h2>
<p>I was very busy during the week of that challenge and was running out of time. Therefore my answers were somewhat minimalist.</p>
<p>I initially tried to redefine the <code>=</code> assignment operator but that appears to be impossible:</p>
<pre><code>Cannot override infix operator '=', as it is a special form handled directly by the compiler
</code></pre>
<p>So, I decided to create my own <code>=:=</code> assignment operator for watched variables. Besides that, the program uses the <code>WatchedValue</code> class to enable the storing of current and past values.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-Perl6" data-lang="Perl6"><span style="color:#66d9ef">use</span> v6;

class WatchedValue {
    has Int $<span style="color:#960050;background-color:#1e0010">.</span>current<span style="color:#f92672">-</span>value is rw;
    has @<span style="color:#960050;background-color:#1e0010">.</span>past<span style="color:#f92672">-</span>values <span style="color:#f92672">=</span> ();

    method get<span style="color:#f92672">-</span>past<span style="color:#f92672">-</span>values {
        <span style="color:#66d9ef">return</span> @<span style="color:#960050;background-color:#1e0010">.</span>past<span style="color:#f92672">-</span>values;
    }
}

multi <span style="color:#66d9ef">sub</span> <span style="color:#a6e22e">infix</span>:&lt;=:=&gt; (WatchedValue $y, Int $z) {
    push $y<span style="color:#f92672">.</span>past<span style="color:#f92672">-</span>values, $y<span style="color:#f92672">.</span>current<span style="color:#f92672">-</span>value;
    $y<span style="color:#f92672">.</span>current<span style="color:#f92672">-</span>value <span style="color:#f92672">=</span> $z;
}
<span style="color:#66d9ef">my</span> $x <span style="color:#f92672">=</span> WatchedValue<span style="color:#f92672">.</span><span style="color:#66d9ef">new</span>(current<span style="color:#f92672">-</span>value <span style="color:#f92672">=&gt;</span> <span style="color:#ae81ff">10</span>);
say <span style="color:#e6db74">&#34;Current: &#34;</span>, $x<span style="color:#f92672">.</span>current<span style="color:#f92672">-</span>value;
$x <span style="color:#f92672">=</span>:<span style="color:#f92672">=</span> <span style="color:#ae81ff">15</span>;
say <span style="color:#e6db74">&#34;Current: &#34;</span>, $x<span style="color:#f92672">.</span>current<span style="color:#f92672">-</span>value;
$x <span style="color:#f92672">=</span>:<span style="color:#f92672">=</span> <span style="color:#ae81ff">5</span>;
say <span style="color:#e6db74">&#34;Current: &#34;</span>, $x<span style="color:#f92672">.</span>current<span style="color:#f92672">-</span>value;
$x <span style="color:#f92672">=</span>:<span style="color:#f92672">=</span> <span style="color:#ae81ff">20</span>;
say <span style="color:#e6db74">&#34;Current: &#34;</span>, $x<span style="color:#f92672">.</span>current<span style="color:#f92672">-</span>value;
say <span style="color:#e6db74">&#34;Past values: &#34;</span>, $x<span style="color:#f92672">.</span>get<span style="color:#f92672">-</span>past<span style="color:#f92672">-</span>values;
</code></pre></div><p>When running the program; I get warnings for each assignment:</p>
<pre><code>Useless use of &quot;=:=&quot; in expression &quot;$x =:= 15&quot; in sink context (line 18)
</code></pre>
<p>I do not know how to avoid or suppress these warnings (it seems that the <code>no warnings ...</code> pragma isn&rsquo;t implemented yet), but the program otherwise runs correctly and displays the successive values:</p>
<pre><code>Current: 10
Current: 15
Current: 5
Current: 20
Past values: [10 15 5]
</code></pre>
<h2 id="alternate-solutions-1">Alternate solutions</h2>
<p>All challengers except Noud and Yet Ebreo used objects of the built-in <a href="https://docs.perl6.org/type/Proxy">Proxy</a> class, which I did not know about before. According to the Perl 6 documentation, a proxy is an object that allows you to set a hook that executes whenever a value is retrieved from a container (<code>FETCH</code>) or when it is set (<code>STORE</code>). This is quite obviously the right tool for solving the task at hand. This is the example provided in the official Perl 6 documentation to create a container that returns twice what was stored in it:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-Perl6" data-lang="Perl6"><span style="color:#66d9ef">sub</span> <span style="color:#a6e22e">double</span>() <span style="color:#a6e22e">is</span> <span style="color:#a6e22e">rw</span> {
    <span style="color:#66d9ef">my</span> $storage <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>;
    Proxy<span style="color:#f92672">.</span><span style="color:#66d9ef">new</span>(
        FETCH <span style="color:#f92672">=&gt;</span> method ()     { $storage <span style="color:#f92672">*</span> <span style="color:#ae81ff">2</span>    },
        STORE <span style="color:#f92672">=&gt;</span> method ($new) { $storage <span style="color:#f92672">=</span> $new },
    )
 }
 <span style="color:#66d9ef">my</span> $doubled :<span style="color:#f92672">=</span> double();
 $doubled <span style="color:#f92672">=</span> <span style="color:#ae81ff">4</span>;
 say $doubled;       <span style="color:#75715e"># OUTPUT: «8</span>
<span style="color:#960050;background-color:#1e0010">»</span>
</code></pre></div><p><a href="https://github.com/manwar/perlweeklychallenge-club/blob/master/challenge-027/arne-sommer/perl6/ch-2.p6">Arne Sommer</a>&lsquo;s program defines a<code>%hist</code> hash to store values according to their time stamp, and then defines the <code>memoryvariable</code> subroutine creating and returning <code>Proxy</code> object:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-Perl6" data-lang="Perl6"><span style="color:#66d9ef">sub</span> <span style="color:#a6e22e">memoryvariable</span>($label) is rw
{
  <span style="color:#66d9ef">my</span> $val;
  Proxy<span style="color:#f92672">.</span><span style="color:#66d9ef">new</span>(
    FETCH <span style="color:#f92672">=&gt;</span> method ()
    {
        $val
    },
    STORE <span style="color:#f92672">=&gt;</span> method ($new)
    {
        $val <span style="color:#f92672">=</span> $new;
        %hist{$label}<span style="color:#f92672">.</span>push( Pair(now<span style="color:#f92672">.</span>Int <span style="color:#f92672">=&gt;</span> $new) );
    },
  );
}
</code></pre></div><p>Arne also defines two additional subroutines, one for displaying the stored historical values and another to output historical values along with the associated time stamp. For example, the second subroutine might display the following:</p>
<pre><code>2019-10-06T17:35:10+02:00: 10
2019-10-06T17:35:10+02:00: 20
2019-10-06T17:35:10+02:00: 15
</code></pre>
<p><a href="https://github.com/manwar/perlweeklychallenge-club/blob/master/challenge-027/kevin-colyer/perl6/ch-2.p6">Kevin Colyer</a> created a <code>HistoryInt</code> class also using a <code>Proxy</code> object, storing the historical values in an array attribute (<code>@.history</code>) of the <code>HistoryInt</code> class:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-Perl6" data-lang="Perl6">class HistoryInt {
  has Int $<span style="color:#960050;background-color:#1e0010">.</span>x <span style="color:#f92672">=</span><span style="color:#ae81ff">0</span> ;
  has @<span style="color:#960050;background-color:#1e0010">.</span>history;

  method x () is rw {
    Proxy<span style="color:#f92672">.</span><span style="color:#66d9ef">new</span>(
      FETCH <span style="color:#f92672">=&gt;</span> <span style="color:#f92672">-&gt;</span> $ { $<span style="color:#960050;background-color:#1e0010">!</span>x },
      STORE <span style="color:#f92672">=&gt;</span> <span style="color:#f92672">-&gt;</span> $, Int $new {
        $<span style="color:#960050;background-color:#1e0010">!</span>x <span style="color:#f92672">=</span> $new;
        @<span style="color:#960050;background-color:#1e0010">!</span>history<span style="color:#f92672">.</span>push: $new;
      }
    )
  }
  method History () {
    @<span style="color:#960050;background-color:#1e0010">!</span>history;
  }
}
</code></pre></div><p><a href="https://github.com/manwar/perlweeklychallenge-club/blob/master/challenge-027/markus-holzer/perl6/ch-2.p6">Markus Holzer</a>&lsquo;s program is extremely concise:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-Perl6" data-lang="Perl6"><span style="color:#66d9ef">use</span> Scalar::History;

<span style="color:#66d9ef">my</span> Int $x :<span style="color:#f92672">=</span> Scalar::History<span style="color:#f92672">.</span>create(<span style="color:#ae81ff">10</span>, Int);
$x <span style="color:#f92672">=</span> <span style="color:#ae81ff">20</span>;
$x <span style="color:#f92672">-=</span> <span style="color:#ae81ff">5</span>;
</code></pre></div><p>thanks to the fact that it uses the <a href="https://github.com/holli-holzer/perl6-Scalar-History">Scalar::History</a> module, which he wrote and is still in development stage (it should presumably go to CPAN some time in the future when completed). This module also uses <code>Proxy</code> objects.</p>
<p><a href="https://github.com/manwar/perlweeklychallenge-club/blob/master/challenge-027/simon-proctor/perl6/ch-2.p6">Simon Proctor</a> implemented a <code>Historic</code> class with a <code>@!values</code> attribute, implementing various setters and getters and using <code>Proxy</code> objects. One very interesting point is that he also implemented a <code>Δ=</code> operator to handle <code>Historic</code> objects:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-Perl6" data-lang="Perl6">multi <span style="color:#66d9ef">sub</span> <span style="color:#a6e22e">infix</span>:&lt;Δ=&gt; ( Any:U $h is rw, Any $v ) is equiv(&amp;infix:&lt;=&gt;) {
     $h <span style="color:#f92672">=</span> Historic<span style="color:#f92672">.</span><span style="color:#66d9ef">new</span>();
     $h<span style="color:#f92672">.</span>set( $v );
     $h;
}

multi <span style="color:#66d9ef">sub</span> <span style="color:#a6e22e">infix</span>:&lt;Δ=&gt; (Historic:D $h, Any $a) is equiv(&amp;infix:&lt;=&gt;) {
    $h<span style="color:#f92672">.</span>set($a);
    <span style="color:#66d9ef">return</span> $h;
}
</code></pre></div><p><a href="https://github.com/manwar/perlweeklychallenge-club/blob/master/challenge-027/joelle-maslak/perl6/ch-2.p6">Joelle Maslak</a> implemented a <code>History</code> class with the <code>@!hist</code> and <code>$!data</code> attributes, also using <code>Proxy</code> objects:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-Perl6" data-lang="Perl6">class History {
    has @<span style="color:#960050;background-color:#1e0010">!</span>hist;
    has $<span style="color:#960050;background-color:#1e0010">!</span>data;

    method get<span style="color:#f92672">-</span>proxy() is rw {
        <span style="color:#66d9ef">my</span> $data    :<span style="color:#f92672">=</span> $<span style="color:#960050;background-color:#1e0010">!</span>data;
        <span style="color:#66d9ef">my</span> $history :<span style="color:#f92672">=</span> @<span style="color:#960050;background-color:#1e0010">!</span>hist;
        Proxy<span style="color:#f92672">.</span><span style="color:#66d9ef">new</span>(
            FETCH <span style="color:#f92672">=&gt;</span> method ()     { $data },
            STORE <span style="color:#f92672">=&gt;</span> method ($val) { $data <span style="color:#f92672">=</span> $val; $history<span style="color:#f92672">.</span>push( $data<span style="color:#f92672">.</span>clone ) },
        );
    }

    method history() {
        <span style="color:#66d9ef">my</span> @h <span style="color:#f92672">=</span> @<span style="color:#960050;background-color:#1e0010">!</span>hist;
        <span style="color:#66d9ef">return</span> @h;
    }
}
</code></pre></div><p><a href="https://github.com/manwar/perlweeklychallenge-club/blob/master/challenge-027/ruben-westerberg/perl6/ch-2.p6">Ruben Westerberg</a> used a <code>@history</code> array to store the successive values of a <code>Proxy</code> object:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-Perl6" data-lang="Perl6"><span style="color:#66d9ef">sub</span> <span style="color:#a6e22e">remembering</span> (@history) {
    <span style="color:#66d9ef">return</span><span style="color:#f92672">-</span>rw Proxy<span style="color:#f92672">.</span><span style="color:#66d9ef">new</span>(
        FETCH <span style="color:#f92672">=&gt;</span> method () {@history[<span style="color:#f92672">*-</span><span style="color:#ae81ff">1</span>]},
        STORE <span style="color:#f92672">=&gt;</span> method ($new) {;@history<span style="color:#f92672">.</span>push($new)}
    );
}
</code></pre></div><p><a href="https://github.com/manwar/perlweeklychallenge-club/blob/master/challenge-027/noud/perl6/ch-2.p6">Noud</a> wrote a program that reads another program and writes a third one. His program takes another program as an argument and parses it to collect information about the variables used in this other script. After that, it creates a <code>%var_hash_</code> that updates the current values of each of the defined variables after each semicolon. The new script is then executed using the EVAL method. Noud humourously comments that he hopes he doesn&rsquo;t get banned from the Perl Weekly Challenge club for using the dangerous <code>EVAL</code> statement in this problem. He certainly shouldn&rsquo;t be banned, especially not for writing such an innovative solution! It is worth quoting the whole program:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-Perl6" data-lang="Perl6"><span style="color:#66d9ef">use</span> MONKEY<span style="color:#f92672">-</span>SEE<span style="color:#f92672">-</span>NO<span style="color:#f92672">-</span>EVAL;

<span style="color:#66d9ef">sub</span> <span style="color:#a6e22e">MAIN</span>(Str $filename) {
    <span style="color:#75715e"># Collect all variables in program.</span>
    <span style="color:#66d9ef">my</span> @variables <span style="color:#f92672">=</span> ();
    <span style="color:#66d9ef">for</span> $filename<span style="color:#f92672">.</span>IO<span style="color:#f92672">.</span>slurp<span style="color:#f92672">.</span>split(<span style="color:#e6db74">&#34;;&#34;</span>) <span style="color:#f92672">-&gt;</span> $line {
        <span style="color:#66d9ef">my</span> @line_var <span style="color:#f92672">=</span> ($line <span style="color:#f92672">~~</span> <span style="color:#e6db74">/my\s*\$(\w+)/</span>)<span style="color:#f92672">.</span>values;
        <span style="color:#66d9ef">if</span> (@line_var<span style="color:#f92672">.</span>elems <span style="color:#f92672">&gt;</span> <span style="color:#ae81ff">0</span>) {
            @variables <span style="color:#f92672">=</span> (<span style="color:#f92672">|</span>(@line_var), <span style="color:#f92672">|</span>(@variables));
        }
    }

    <span style="color:#66d9ef">my</span> $exec_prog <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;&#34;</span>;
    <span style="color:#66d9ef">for</span> $filename<span style="color:#f92672">.</span>IO<span style="color:#f92672">.</span>slurp<span style="color:#f92672">.</span>split(<span style="color:#e6db74">&#34;;&#34;</span>) <span style="color:#f92672">-&gt;</span> $line {
        $exec_prog <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;$exec_prog $line\;&#34;</span>;
        <span style="color:#75715e"># After every line update %var_hash_ with the current variable values.</span>
        <span style="color:#66d9ef">for</span> @variables <span style="color:#f92672">-&gt;</span> $x {
            $exec_prog <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;$exec_prog
</span><span style="color:#e6db74">                if (not DYNAMIC::&lt;\$$x&gt; === Nil) \{
</span><span style="color:#e6db74">                    \%var_hash_\.push: ($x =&gt; DYNAMIC::&lt;\$$x&gt;)\; \}\;&#34;</span>;
        }
    }

    <span style="color:#66d9ef">my</span> %var_hash_;
    EVAL $exec_prog;  <span style="color:#75715e"># https://xkcd.com/292/</span>

    say <span style="color:#e6db74">&#34;Variables history:&#34;</span>;
    <span style="color:#66d9ef">for</span> %var_hash_<span style="color:#f92672">.</span>kv <span style="color:#f92672">-&gt;</span> $var, @hist {
        <span style="color:#66d9ef">my</span> @hist_ <span style="color:#f92672">=</span> @hist<span style="color:#f92672">.</span>grep({ <span style="color:#f92672">not</span> $_<span style="color:#f92672">.^</span>name <span style="color:#f92672">===</span> <span style="color:#e6db74">&#34;Any&#34;</span> });
        <span style="color:#66d9ef">if</span> (@hist_<span style="color:#f92672">.</span>elems <span style="color:#f92672">&gt;</span> <span style="color:#ae81ff">0</span>) {
            <span style="color:#66d9ef">print</span>(<span style="color:#e6db74">&#34;$var = (&#34;</span>);
            <span style="color:#66d9ef">my</span> $last <span style="color:#f92672">=</span> @hist_[<span style="color:#ae81ff">0</span>];
            <span style="color:#66d9ef">print</span>(<span style="color:#e6db74">&#34;$last&#34;</span>);
            <span style="color:#66d9ef">for</span> @hist_[<span style="color:#ae81ff">1</span><span style="color:#f92672">..*</span>] <span style="color:#f92672">-&gt;</span> $next {
                <span style="color:#66d9ef">if</span> ($last <span style="color:#f92672">!=</span> $next) {
                    <span style="color:#66d9ef">print</span>(<span style="color:#e6db74">&#34;, $next&#34;</span>);
                    $last <span style="color:#f92672">=</span> $next;
                }
            }
            <span style="color:#66d9ef">print</span>(<span style="color:#e6db74">&#34;)\n&#34;</span>);
        }
    }
}
</code></pre></div><p><a href="https://github.com/manwar/perlweeklychallenge-club/blob/master/challenge-027/yet-ebreo/perl6/ch-2.p6">Yet Ebreo</a> created an <em>apparently</em> very simple <code>hist</code> class with a <code>STORE</code> method:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-Perl6" data-lang="Perl6">class hist {
    has @<span style="color:#960050;background-color:#1e0010">.</span>history;
    has $<span style="color:#960050;background-color:#1e0010">!</span>var handles <span style="color:#f92672">&lt;</span>Str gist FETCH Numeric<span style="color:#f92672">&gt;</span>;
    method STORE($val) {
        push @<span style="color:#960050;background-color:#1e0010">.</span>history, $val;
        $<span style="color:#960050;background-color:#1e0010">!</span>var <span style="color:#f92672">=</span> $val;
    }
}
<span style="color:#66d9ef">my</span> <span style="color:#f92672">\</span>x <span style="color:#f92672">=</span> hist<span style="color:#f92672">.</span><span style="color:#66d9ef">new</span>(history <span style="color:#f92672">=&gt;</span> <span style="color:#f92672">[]</span>);

x <span style="color:#f92672">=</span> <span style="color:#ae81ff">10</span>;
x <span style="color:#f92672">=</span> <span style="color:#ae81ff">20</span>;
x <span style="color:#f92672">-=</span> <span style="color:#ae81ff">5</span>;
x <span style="color:#f92672">=</span> <span style="color:#ae81ff">3.1416</span>;
x <span style="color:#f92672">=</span> Q[a quick brown fox jumps over the lazy dog];
x <span style="color:#f92672">=</span> <span style="color:#ae81ff">1e3</span>;
x<span style="color:#f92672">*=</span> sqrt <span style="color:#ae81ff">3</span>;
<span style="color:#f92672">.</span>say  <span style="color:#66d9ef">for</span> x<span style="color:#f92672">.</span>history;
</code></pre></div><p>The code of the <code>hist</code> class seems very simple, but is in fact pretty clever. I must admit that I don&rsquo;t fully grasp it: I don&rsquo;t really understand what the <code>handles</code> trait does in such context, and I am also not quite sure how this (re)definition of the <code>STORE</code> subroutine is supposed to work. If any reader wants to explain this, I would be very happy to update this blog post accordingly.</p>
<hr>
<h2 id="see-also">SEE ALSO</h2>
<p>Only two blog posts this time (in addition to mine):</p>
<ul>
<li>
<p>Arne Sommer: <a href="https://perl6.eu/historical-intersection.html;">https://perl6.eu/historical-intersection.html;</a></p>
</li>
<li>
<p>Roger Bell West: <a href="https://blog.firedrake.org/archive/2019/09/Perl_Weekly_Challenge_27.html">https://blog.firedrake.org/archive/2019/09/Perl_Weekly_Challenge_27.html</a>.</p>
</li>
</ul>
<hr>
<h2 id="wrapping-up">Wrapping up</h2>
<p>Please let me know if I forgot any of the challengers or if you think my explanation of your code misses something important (you can just file an issue against this GitHub page).</p>
<p>If you want to participate to the Perl Weekly Challenge, please connect to <a href="https://perlweeklychallenge.org/">this site</a>.</p>

                </div>
            </div>
        </div>
    </div>
</section>


<!-- Call To Action Section Start -->
<section id="call-to-action">
    <div class="container">
        <div class="row">
            <div class="col-md-12">
                <div class="block">
                    <h2 class="title wow fadeInDown" data-wow-delay=".3s" data-wow-duration="500ms">SO WHAT DO YOU THINK ?</h2>
                    <p class="wow fadeInDown" data-wow-delay=".5s" data-wow-duration="500ms">If you have any suggestions or ideas then please do share with us.</p>
                    <a href="/contact" class="btn btn-default btn-contact wow fadeInDown" data-wow-delay=".7s" data-wow-duration="500ms">Contact with me</a>
                </div>
            </div>

        </div>
    </div>
</section>
<!-- Call To Action Section End -->



<!-- Footer Section Start -->
<footer id="footer">
    <div class="container">
        <div class="row content-justify-between">
            <div class="col-md-8 col-12 text-center text-lg-left text-md-left">
                <p class="copyright">Copyright:
                    <span>
                        2019 - 2024
                    </span> The Weekly Challenge. Theme Design and Developed by
                    <a href="http://www.Themefisher.com" rel="noreferrer" rel="noreferrer" target="_blank">Themefisher</a>.
                </p>
            </div>
            <div class="col-md-4 col-12">
                <!-- Social Media -->
                <ul class="social text-center text-md-right text-lg-right">
                    <li>
                        <a href="https://twitter.com/PerlWChallenge" class="twitter" rel="noreferrer" target="_blank" title="Follow us">
                            <i class="ion-social-twitter"></i>
                        </a>
                    </li>
                    <li>
                        <a href="/rss.xml" class="rss" target="_blank" title="RSS Feed">
                            <i class="ion-social-rss"></i>
                        </a>
                    </li>
                </ul>
            </div>
        </div>
    </div>
</footer>
<!-- footer section end -->

<!-- jquery -->
<script src="https://theweeklychallenge.org/plugins/jquery/jquery.min.js"></script>
<!-- Form Validation -->
<script src="https://theweeklychallenge.org/plugins/form-validation/jquery.form.min.js"></script>
<script src="https://theweeklychallenge.org/plugins/form-validation/jquery.validate.min.js"></script>
<!-- slick slider -->
<script src="https://theweeklychallenge.org/plugins/slick/slick.min.js"></script>
<!-- bootstrap js -->
<script src="https://theweeklychallenge.org/plugins/bootstrap/bootstrap.min.js"></script>
<!-- chart js -->
<script src="https://theweeklychallenge.org/plugins/chart/highstock.js"></script>
<script src="https://theweeklychallenge.org/plugins/chart/drilldown.js"></script>
<script src="https://theweeklychallenge.org/plugins/chart/data.js"></script>
<script src="https://theweeklychallenge.org/plugins/chart/chart.js"></script>
<script src="https://theweeklychallenge.org/plugins/chart/pwc-challenge.js"></script>
<script src="https://theweeklychallenge.org/plugins/chart/gc-challenge.js"></script>
<!-- wow js -->
<script src="https://theweeklychallenge.org/plugins/wow-js/wow.min.js"></script>
<!-- slider js -->
<script src="https://theweeklychallenge.org/plugins/slider/slider.js"></script>
<!-- Fancybox -->
<script src="https://theweeklychallenge.org/plugins/facncybox/jquery.fancybox.js"></script>
<!-- template main js -->

<script src="https://theweeklychallenge.org/js/script.min.js"></script>
<!-- google analitycs -->

<script async src="https://www.googletagmanager.com/gtag/js?id=G-CJTPYM9SB8"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-CJTPYM9SB8');
</script>
</body>

</html>

