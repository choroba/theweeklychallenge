<!DOCTYPE html>
<html class="no-js" lang="en-us">
<head>
    <!-- Basic Page Needs -->

    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta property="og:title"       content="Laurent Rosenfeld Weekly Review: Challenge - 020"/>
    <meta property="og:type"        content="website"/>
    <meta property="og:url"         content="https://theweeklychallenge.org/blog/p6-review-challenge-020/"/>
    <meta property="og:image"       content="https://theweeklychallenge.org/images/about/about.jpg"/>
    <meta property="og:description" content="Laurent Rosenfeld Weekly Review: Challenge - #020."/>
    <meta name="twitter:card"       content="summary" />
    <meta name="twitter:image"      content="https://theweeklychallenge.org/images/about/about.jpg"/>

    <meta http-equiv="Content-Type" content="text/html; charset=utf-8">

    <meta name="description" content="Laurent Rosenfeld Weekly Review: Challenge - #020.">
    <meta name="author" content="The Weekly Challenge Team">
    <meta name="generator" content="Hugo 0.67.0-DEV" />

    <link rel="me" href="https://fosstodon.org/@manwar">
    <link rel="canonical" href="https://theweeklychallenge.org/blog/p6-review-challenge-020/" />

    <!-- Mobile Specific Metas -->
    <meta name="format-detection" content="telephone=no">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Laurent Rosenfeld Weekly Review: Challenge - 020</title>
    <link rel="icon" href="https://theweeklychallenge.org/images/favicon.ico">

    
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.0/css/bootstrap.min.css"/>

    <!-- Twitter Bootstrs CSS -->
    <link rel="stylesheet" href="https://theweeklychallenge.org/plugins/bootstrap/bootstrap.min.css">
    <!-- Ionicons Fonts Css -->
    <link rel="stylesheet" href="https://theweeklychallenge.org/plugins/ionicons/ionicons.min.css">
    <!-- animate css -->
    <link rel="stylesheet" href="https://theweeklychallenge.org/plugins/animate-css/animate.css">
    <!-- Hero area slider css-->
    <link rel="stylesheet" href="https://theweeklychallenge.org/plugins/slider/slider.css">
    <!-- slick slider -->
    <link rel="stylesheet" href="https://theweeklychallenge.org/plugins/slick/slick.css">
    <!-- Fancybox -->
    <link rel="stylesheet" href="https://theweeklychallenge.org/plugins/facncybox/jquery.fancybox.css">
    <!-- hover -->
    <link rel="stylesheet" href="https://theweeklychallenge.org/plugins/hover/hover-min.css">
    <!-- Google fonts -->
    <link href='https://fonts.googleapis.com/css?family=Source Code Pro' rel='stylesheet'>
    <!-- template main css file -->
    
    <link rel="stylesheet" href="https://theweeklychallenge.org/css/style.min.css" integrity="" media="screen">
    <link rel="stylesheet" href="https://theweeklychallenge.org/css/main.css">

    <style>
        #goTopButton {
            display: none;          
            position: fixed;        
            bottom: 20px;           
            right: 30px;            
            z-index: 99;            
            border: none;           
            outline: none;          
            background-color: red;  
            color: white;           
            cursor: pointer;        
            padding: 15px;          
            border-radius: 10px;    
            font-size: 18px;        
        }

        #goTopButton:hover {
              background-color: #555;
        }

        
        .toggle-links {
            margin: 15px 0;
            padding-left: 15px;
        }
        .toggle-links a {
            display: inline-flex;
            align-items: center;
            padding: 8px 16px;
            border-radius: 20px;
            background-color: #4285f4;
            color: white !important;
            text-decoration: none;
            font-weight: 500;
            transition: background-color 0.2s ease;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
        }
        .toggle-links a:hover {
            background-color: #3367d6;
        }
        .arrow-icon {
            margin-left: 8px;
            font-size: 1.1em;
        }

    </style>


</head>

<body>

<button onclick="goTop()" id="goTopButton" title="Go to top">Top</button>

<script>

    topButton = document.getElementById("goTopButton");

    
    window.onscroll = function() { scrollFunction() };

    function scrollFunction() {
        if (document.body.scrollTop > 40 || document.documentElement.scrollTop > 40) {
            topButton.style.display = "block";
        } else {
            topButton.style.display = "none";
        }
    }

    
    function goTop() {
        document.body.scrollTop = 0; 
        document.documentElement.scrollTop = 0; 
    }

    
    document.addEventListener('DOMContentLoaded', function() {
        
        const showMoreLinkGC = document.querySelector('.show-more-gc');
        const showLessLinkGC = document.querySelector('.show-less-gc');
        const hiddenLinksGC = document.querySelectorAll('.hidden-link-gc');

        if (showMoreLinkGC) {
            showMoreLinkGC.addEventListener('click', function(e) {
                e.preventDefault();
                hiddenLinksGC.forEach(link  => {
                    link.style.display = 'list-item';
                });
                showMoreLinkGC.style.display = 'none';
                showLessLinkGC.style.display = 'inline-flex';
            });
        }

        if (showLessLinkGC) {
            showLessLinkGC.addEventListener('click', function(e) {
                e.preventDefault();
                hiddenLinksGC.forEach(link  => {
                    link.style.display = 'none';
                });
                showLessLinkGC.style.display = 'none';
                showMoreLinkGC.style.display = 'inline-flex';
            });
        }

        
        const showMoreLinkPWC = document.querySelector('.show-more-pwc');
        const showLessLinkPWC = document.querySelector('.show-less-pwc');
        const hiddenLinksPWC = document.querySelectorAll('.hidden-link-pwc');

        if (showMoreLinkPWC) {
            showMoreLinkPWC.addEventListener('click', function(e) {
                e.preventDefault();
                hiddenLinksPWC.forEach(link  => {
                    link.style.display = 'list-item';
                });
                showMoreLinkPWC.style.display = 'none';
                showLessLinkPWC.style.display = 'inline-flex';
            });
        }

        if (showLessLinkPWC) {
            showLessLinkPWC.addEventListener('click', function(e) {
                e.preventDefault();
                hiddenLinksPWC.forEach(link  => {
                    link.style.display = 'none';
                });
                showLessLinkPWC.style.display = 'none';
                showMoreLinkPWC.style.display = 'inline-flex';
            });
        }
    });

</script>

<section class="top-bar animated-header">
    <div class="container">
        <div class="row">
            <div class="col-lg-12">
                <nav class="navbar navbar-expand-lg navbar-light bg-light">
                    <a class="navbar-brand" href="https://theweeklychallenge.org/">
                        <img src="https://theweeklychallenge.org/images/logo.svg" alt="logo">
                    </a>

                    <button class="navbar-toggler d-lg-none"
                            type="button"
                            data-toggle="collapse"
                            data-target="#navigation"
                            aria-controls="navigation"
                            aria-expanded="false"
                            aria-label="Toggle navigation">
                        <span class="navbar-toggler-icon"></span>
                    </button>

                    <div class="navbar-collapse" id="navigation">
                        <ul class="navbar-nav ml-auto">
                            <li class="nav-item">
                                <a class="nav-link" href="https://theweeklychallenge.org/">Home</a>
                            </li>
                            
                            <li class="nav-item">
                                <a class="nav-link" href="https://theweeklychallenge.org/about">About</a>
                            </li>
                            
                            <li class="nav-item">
                                <a class="nav-link" href="https://theweeklychallenge.org/chart">Chart</a>
                            </li>
                            
                            <li class="nav-item">
                                <a class="nav-link" href="https://theweeklychallenge.org/champions">Champions</a>
                            </li>
                            
                            <li class="nav-item">
                                <a class="nav-link" href="https://theweeklychallenge.org/team">Team</a>
                            </li>
                            
                            <li class="nav-item">
                                <a class="nav-link" href="https://theweeklychallenge.org/challenges">Challenges</a>
                            </li>
                            
                            <li class="nav-item">
                                <a class="nav-link" href="https://theweeklychallenge.org/p5-reviews">Perl/Review</a>
                            </li>
                            
                            <li class="nav-item">
                                <a class="nav-link" href="https://theweeklychallenge.org/p6-reviews">Raku/Review</a>
                            </li>
                            
                            <li class="nav-item">
                                <a class="nav-link" href="https://theweeklychallenge.org/recaps">Recaps</a>
                            </li>
                            
                            <li class="nav-item">
                                <a class="nav-link" href="https://theweeklychallenge.org/blogs">Blogs</a>
                            </li>
                            
                            <li class="nav-item">
                                <a class="nav-link" href="https://theweeklychallenge.org/faq">FAQ</a>
                            </li>
                            
                            <li class="nav-item">
                                <a class="nav-link" href="https://theweeklychallenge.org/contact">Contact</a>
                            </li>
                            
                        </ul>
                    </div>
                </nav>
            </div>
        </div>
    </div>
</section>


<section class="global-page-header">
    <div class="container">
        <div class="row">
            <div class="col-md-12">
                <div class="block">
                    <h2>Laurent Rosenfeld Weekly Review: Challenge - 020</h2>
                    <div class="portfolio-meta">
                        <span>Wednesday, Oct 9, 2019</span>|
                        <span> Tags:
                            Raku
                        </span>
                    </div>
                </div>
            </div>
        </div>
    </div>
</section>

<section class="single-post">
    <div class="container">
        <div class="row">
            <div class="col-md-12">
                
                <div style="text-align: center" class="post-img">
                    <img class="img-fluid" alt="" src="https://theweeklychallenge.org/images/blog/p6-review-challenge-020.jpg">
                </div>
                
                <div style="text-align: justify" class="post-content">
                    <hr>
<h1 id="raku-solutions-weekly-review">Raku Solutions Weekly Review</h1>
<hr>
<h2 id="task-1-split-strings-on-character-change">Task #1: Split Strings on Character Change</h2>
<p>This is derived from my <a href="http://blogs.perl.org/users/laurent_r/2019/08/perl-weekly-challenge-20-split-string-on-character-change-and-amicable-numbers.html">blog post</a> made in answer to the <a href="https://perlweeklychallenge.org/blog/perl-weekly-challenge-020/">Week 20 of the Perl Weekly Challenge</a> organized by  <a href="http://blogs.perl.org/users/mohammad_s_anwar/">Mohammad S. Anwar</a> as well as answers made by others to the same challenge.</p>
<p>The challenge reads as follows:</p>
<p><em>Write a script to accept a string from command line and split it on change of character. For example, if the string is &ldquo;ABBCDEEF&rdquo;, then it should split like &ldquo;A&rdquo;, &ldquo;BB&rdquo;, &ldquo;C&rdquo;, &ldquo;D&rdquo;, &ldquo;EE&rdquo;, &ldquo;F&rdquo;.</em></p>
<h2 id="my-solutions">My Solutions</h2>
<p>For this, it seemed fairly obvious to me that a simple regex in a one-liner should do the trick.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell">$ perl6 -e <span style="color:#e6db74">&#39;say ~$/ if &#34;ABBBCDEEF&#34; ~~ m:g/( (.) $0*)/;&#39;</span>
A BBB C D EE F

$ perl6 -e <span style="color:#e6db74">&#39;say ~$/ if &#34;ABBCDEEF&#34; ~~ m:g/( (.) $0*)/;&#39;</span>
A BB C D EE F
</code></pre></div><p>The <code>((.)$0*)</code> pattern looks for repeated characters and stores the captured groups of identical characters into the <code>$/</code> match object, which we just need to stringify for outputting it.</p>
<p>Just in case the quote marks and commas are part of the desired output (which I don&rsquo;t really believe), we can fix that easily:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell">$ perl6 -e <span style="color:#e6db74">&#39;print join &#34;, &#34;, map {&#34;\&#34;$_\&#34;&#34;}, &#34;ABBCDEEF&#34; ~~ m:g/((.)$0*)/&#39;</span>
<span style="color:#e6db74">&#34;A&#34;</span>, <span style="color:#e6db74">&#34;BB&#34;</span>, <span style="color:#e6db74">&#34;C&#34;</span>, <span style="color:#e6db74">&#34;D&#34;</span>, <span style="color:#e6db74">&#34;EE&#34;</span>, <span style="color:#e6db74">&#34;F&#34;</span>
</code></pre></div><p>If we don&rsquo;t want to use a regex and prefer a more traditional procedural approach, we can split the input string, loop through each letter individually, and take actions depending on whether the current letter is equal to the previous one. For example:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-perl6" data-lang="perl6"><span style="color:#66d9ef">use</span> v6;

<span style="color:#66d9ef">sub</span> <span style="color:#a6e22e">split</span>-str ($in) {
    <span style="color:#66d9ef">my</span> $prev <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;&#34;</span>;
    <span style="color:#66d9ef">my</span> $tmp<span style="color:#f92672">-</span>str <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;&#34;</span>;
    <span style="color:#66d9ef">my</span> @out;
    <span style="color:#66d9ef">for</span> $in<span style="color:#f92672">.</span>comb <span style="color:#f92672">-&gt;</span> $letter {
        <span style="color:#66d9ef">if</span> $letter <span style="color:#f92672">eq</span> $prev {
            $tmp<span style="color:#f92672">-</span>str <span style="color:#f92672">~=</span> $letter;
        } <span style="color:#66d9ef">else</span> {
            push @out, $tmp<span style="color:#f92672">-</span>str <span style="color:#66d9ef">if</span> $tmp<span style="color:#f92672">-</span>str <span style="color:#f92672">ne</span> <span style="color:#e6db74">&#34;&#34;</span>;
            $tmp<span style="color:#f92672">-</span>str <span style="color:#f92672">=</span> $letter;
            $prev <span style="color:#f92672">=</span> $letter;
        }
    }
    push @out, $tmp<span style="color:#f92672">-</span>str;
    <span style="color:#66d9ef">return</span> join <span style="color:#e6db74">&#34;, &#34;</span>, @out;
}

<span style="color:#66d9ef">sub</span> <span style="color:#a6e22e">MAIN</span> (Str $input = &#34;ABBBCDEEF&#34;) {
    say split<span style="color:#f92672">-</span>str $input;
}
</code></pre></div><p>When using the default input parameter (<code>&quot;ABBBCDEEF&quot;</code>), this prints the following:</p>
<pre><code>$ perl6 split-string.p6
A, BBB, C, D, EE, F
</code></pre>
<h2 id="alternative-solutions">Alternative Solutions</h2>
<p><a href="https://github.com/manwar/perlweeklychallenge-club/blob/master/challenge-020/arne-sommer/perl6/ch-1.p6">Arne Sommer</a> devised a solution somewhat similar to the procedural approach I outlined just above: splitting the input string into an array of individual letters and then loop over each letter to check whether it is the same as the previous one . <a href="https://github.com/manwar/perlweeklychallenge-club/blob/master/challenge-020/adam-russell/perl6/ch-1.p6">Adam Russell</a>, who was apparently offering solutions in Perl 6 for the first time, also used a procedural approach, but he used a <code>repeat ... while</code> loop and he printed the letters on the fly within the loop.</p>
<p><a href="https://github.com/manwar/perlweeklychallenge-club/blob/master/challenge-020/ruben-westerberg/perl6/ch-1.p6">Ruben Westerberg</a> also used a procedural approach on an array of letters, but with a fairly original and clever use of <code>state</code> variables, as well a somewhat unexpected use of the <code>when ... default</code> construct; his solution is also the only one using <code>NEXT</code> and <code>LAST</code> phasers.</p>
<p><a href="https://github.com/manwar/perlweeklychallenge-club/blob/master/challenge-020/jaldhar-h-vyas/perl6/ch-1.sh">Jaldhar H Vyas</a> was the only person other than me to suggest a Perl 6 one-liner and also the only person to use the regex pattern (similar to mine) in a substitution rather than a simple match:</p>
<pre><code>perl6 -e ' @*ARGS.shift.subst(/ ( (.)$0* ) /, { &quot;\&quot;$0\&quot;&quot; }, :g).subst(&quot;\&quot;\&quot;&quot;, &quot;\&quot;, \&quot;&quot;, :g).say; ' &quot;ABBCDEEF&quot;
</code></pre>
<p><a href="https://github.com/manwar/perlweeklychallenge-club/blob/master/challenge-020/fjwhittle/perl6/ch-1.p6">Francis Whittle</a>, <a href="https://github.com/manwar/perlweeklychallenge-club/blob/master/challenge-020/martin-barth/perl6/ch-1.p6">Martin Barth</a>, <a href="https://github.com/manwar/perlweeklychallenge-club/blob/master/challenge-020/randy-lauen/perl6/ch-1.p6">Randy Lauen</a>, <a href="https://github.com/manwar/perlweeklychallenge-club/blob/master/challenge-020/joelle-maslak/perl6/ch-1.p6">Joelle Maslak</a>, and <a href="https://github.com/manwar/perlweeklychallenge-club/blob/master/challenge-020/feng-chang/perl6/ch-1.p6">Feng Chang</a> used regex patterns almost identical to mine above, but used that pattern as a parameter to the <code>comb</code> built-in function. As an example, this is Joelle&rsquo;s solution:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-perl6" data-lang="perl6"><span style="color:#66d9ef">sub</span> <span style="color:#a6e22e">MAIN</span>(Str:D $input) {
    <span style="color:#66d9ef">my</span> @matches <span style="color:#f92672">=</span> $input<span style="color:#f92672">.</span>comb(<span style="color:#e6db74"> / (.) $0* /</span> );
    say @matches<span style="color:#f92672">.</span>join(<span style="color:#e6db74">&#34;\n&#34;</span>);
}
</code></pre></div><p><a href="https://github.com/manwar/perlweeklychallenge-club/blob/master/challenge-020/kevin-colyer/perl6/ch-1.p6">Kevin Colyer</a>, <a href="https://github.com/manwar/perlweeklychallenge-club/blob/master/challenge-020/noud/perl6/ch-1.p6">Noud</a>, and <a href="https://github.com/manwar/perlweeklychallenge-club/blob/master/challenge-020/athanasius/perl6/ch-1.p6">Athanasius</a> used the same regex pattern as I did along with a similar syntax to retrieve the bits and pieces.</p>
<p><a href="https://github.com/manwar/perlweeklychallenge-club/blob/master/challenge-020/ozzy/perl6/ch-1.p6">Ozzy</a> also used a regex, but with named captures rather than using the <code>$0</code> special variable (which is really a shortcut for <code>$/[0]</code>):</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-perl6" data-lang="perl6">$string<span style="color:#f92672">.</span>match: <span style="color:#e6db74">/ ( $&lt;l&gt;=&lt;.alpha&gt; $&lt;l&gt;* )+ /</span>;    <span style="color:#75715e"># Quantified capture yields array $/[0] of Match objects</span>
say $/[<span style="color:#ae81ff">0</span>][<span style="color:#f92672">*</span>]<span style="color:#f92672">.</span>Str;                               <span style="color:#75715e"># Stringify each Match object to see the overall match</span>
</code></pre></div><p><a href="https://github.com/manwar/perlweeklychallenge-club/blob/master/challenge-020/roger-bell-west/perl6/ch-1.p6">Roger Bell West</a> also used something similar to a named capture (although it is really assigning a capture number to a variable):</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-perl6" data-lang="perl6"><span style="color:#66d9ef">sub</span> <span style="color:#a6e22e">splitchange</span> ($in) {
   <span style="color:#66d9ef">return</span> map {$_<span style="color:#f92672">.</span>Str}, $in <span style="color:#f92672">~~</span> m:g<span style="color:#e6db74">/(.) {} :my $c = $0; ($c*)/</span>;
}
</code></pre></div><p>Although Damian Conway doesn&rsquo;t participate directly to the Perl Weekly Challenge, but usually comments on it afterwards, his beautifully crafted solutions are always worth contemplating. His <a href="http://blogs.perl.org/users/damian_conway/2019/08/with-friends-like-these.html">latest blog</a> suggests a regex as a parameter to the <code>comb</code> builtin subroutine:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-perl6" data-lang="perl6"><span style="color:#66d9ef">use</span> v6<span style="color:#f92672">.</span>d;

<span style="color:#66d9ef">sub</span> <span style="color:#a6e22e">MAIN</span> (\str) {
    <span style="color:#f92672">.</span>say <span style="color:#66d9ef">for</span> str<span style="color:#f92672">.</span>comb: <span style="color:#e6db74">/(.) $0*/</span>
}
</code></pre></div><h1 id="task-2-amicable-numbers">Task #2: Amicable Numbers</h1>
<p>This is derived from my <a href="http://blogs.perl.org/users/laurent_r/2019/08/perl-weekly-challenge-20-split-string-on-character-change-and-amicable-numbers.html">blog post</a> made in answer to the <a href="https://perlweeklychallenge.org/blog/perl-weekly-challenge-020/">Week 20 of the Perl Weekly Challenge</a> organized by  <a href="http://blogs.perl.org/users/mohammad_s_anwar/">Mohammad S. Anwar</a> as well as answers made by others to the same challenge.</p>
<p>The challenge reads as follows:</p>
<p><em>Write a script to print the smallest pair of Amicable Numbers. For more information, please checkout <a href="https://en.wikipedia.org/wiki/Amicable_numbers">wikipedia page</a>.</em></p>
<p>Amicable numbers are two different numbers so related that the sum of the proper divisors of each is equal to the other number. (A proper divisor of a number is a positive factor of that number other than the number itself. For example, the proper divisors of 6 are 1, 2, and 3.)</p>
<h2 id="my-solution">My Solution</h2>
<p>We&rsquo;ll use the <code>sum-divisors</code> subroutine to find the divisors of a given number and return their sum. This subroutine uses trial division, i.e. tries division by all integers below a certain limit (here, half of the input number), and then sums up all those that evenly divide the input number. Then, we just loop over a lazy infinite list of integers from 2 onward and call <code>sum_divisors</code> subroutine. If the sum of divisors is larger than the integer being examined (if it is smaller, then it is a pair of numbers that we have already checked), then we check the sum of divisors of the sum of divisors. If it is equal to the current integer, then we&rsquo;ve found two amicable numbers and can print them and exit the loop.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-perl6" data-lang="perl6"><span style="color:#66d9ef">use</span> v6;

<span style="color:#66d9ef">sub</span> <span style="color:#a6e22e">sum</span>-divisors (Int $num) {
    <span style="color:#66d9ef">my</span> @divisors <span style="color:#f92672">=</span> grep { $num %% <span style="color:#960050;background-color:#1e0010">$</span>_ }, <span style="color:#ae81ff">2</span><span style="color:#f92672">..</span>($num <span style="color:#f92672">/</span> <span style="color:#ae81ff">2</span>)<span style="color:#f92672">.</span>Int;
    <span style="color:#66d9ef">return</span> [<span style="color:#f92672">+</span>] <span style="color:#ae81ff">1</span>, <span style="color:#f92672">|</span> @divisors;
}

<span style="color:#66d9ef">for</span> <span style="color:#ae81ff">2</span><span style="color:#f92672">..</span>Inf <span style="color:#f92672">-&gt;</span> $i {
    <span style="color:#66d9ef">my</span> $sum_div <span style="color:#f92672">=</span> sum<span style="color:#f92672">-</span>divisors $i;
    <span style="color:#66d9ef">if</span> $sum_div <span style="color:#f92672">&gt;</span> $i <span style="color:#f92672">and</span> $i <span style="color:#f92672">==</span> sum<span style="color:#f92672">-</span>divisors $sum_div {
        say <span style="color:#e6db74">&#34;$i and $sum_div are amicable numbers&#34;</span>;
        <span style="color:#66d9ef">last</span>;
    }
}
</code></pre></div><p>The <code>sum-divisors</code> subroutine is not optimal and its performance could be greatly enhanced, but we don&rsquo;t need to do that since we&rsquo;re looking only for the first pair of amicable numbers, which are rather small. Also, I did not have much time on that week because I was quite busy with the Perl Conference in Riga.</p>
<p>This program prints almost instantly the first pair of amicable numbers:</p>
<pre><code>$ perl6 amicable_nrs.p6
220 and 284 are amicable numbers
</code></pre>
<p>Note that the Wikipedia article shows some rules to quickly find some amicable numbers (Thābit ibn Qurra&rsquo;s theorem and Euler&rsquo;s rule), but I did not want to use any of these because neither Thābit ibn Qurra&rsquo;s theorem, nor Euler&rsquo;s method will produce all amicable numbers, so that it is not guaranteed that we would find the first pair with such methods (although it so happens that both methods do produce the first pair).</p>
<h2 id="alternative-solutions-1">Alternative Solutions</h2>
<p><a href="https://github.com/manwar/perlweeklychallenge-club/blob/master/challenge-020/arne-sommer/perl6/ch-2.p6">Arne Sommer</a> used essentially the same method, except that his <code>proper-divisors</code> subroutine returns a list of proper divisors which are then added in the calling code.</p>
<p><a href="https://github.com/manwar/perlweeklychallenge-club/blob/master/challenge-020/ruben-westerberg/perl6/ch-2.p6">Ruben Westerberg</a> also uses essentially the same method, but his <code>proper</code> subroutine is particularly concise:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-perl6" data-lang="perl6"><span style="color:#66d9ef">sub</span> <span style="color:#a6e22e">proper</span>(\n) {
    sum (<span style="color:#ae81ff">1</span><span style="color:#f92672">..</span>n<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>)<span style="color:#f92672">.</span>grep({ n%%$_});
}
</code></pre></div><p><a href="https://github.com/manwar/perlweeklychallenge-club/blob/master/challenge-020/fjwhittle/perl6/ch-2.p6">Francis Whittle</a> used multi <code>MAIN</code> subroutines to use either Euler&rsquo;s rule or the naive trial division algorithm described in my solution above. One interesting thing in Francis&rsquo;s naive implementation is that is <code>proper-divisor-sum</code> is using the <code>is cached</code> trait to avoid recomputing the proper divisors of a number if it has already been calculated.</p>
<p><a href="https://github.com/manwar/perlweeklychallenge-club/blob/master/challenge-020/kevin-colyer/perl6/ch-2.p6">Kevin Colyer</a> and <a href="https://github.com/manwar/perlweeklychallenge-club/blob/master/challenge-020/randy-lauen/perl6/ch-2.p6">Randy Lauen</a> also cached the sums of proper divisors, but did it manually by storing them into a hash. <a href="https://github.com/manwar/perlweeklychallenge-club/blob/master/challenge-020/noud/perl6/ch-2.p6">Noud</a> also cached the results returned by <code>prop_div</code> subroutine, but did that in an original way by adding a wrapper to the subroutine.</p>
<p><a href="https://github.com/manwar/perlweeklychallenge-club/blob/master/challenge-020/adam-russell/perl6/ch-2.p6">Adam Russell</a> used the same general algorithm, but interestingly used <a href="https://docs.perl6.org/type/Promise">promises</a> to parallelize part of the work over several concurrent threads and presumably speed up the search.</p>
<p><a href="https://github.com/manwar/perlweeklychallenge-club/blob/master/challenge-020/athanasius/perl6/ch-2.p6">Athanasius</a> used the <code>divisor_sum</code> subroutine of the CPAN <code>Math::Prime::Util</code> <em>Perl 5</em> module and further created an alias on it presumably to make its use easier:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-Perl6" data-lang="Perl6"><span style="color:#66d9ef">use</span> Math::Prime::Util:from<span style="color:#e6db74">&lt;Perl5&gt;</span> <span style="color:#e6db74">&lt;divisor_sum&gt;</span>;
<span style="color:#66d9ef">my</span> Sub $divisor<span style="color:#f92672">-</span>sum :<span style="color:#f92672">=</span> <span style="color:#f92672">&amp;</span>Math::Prime::Util::divisor_sum;     <span style="color:#75715e"># Alias</span>
</code></pre></div><p>This is really cool, as it is a good example showing how a fairly large part of the Perl 5 ecosystem can be used in Perl 6. Note, however that the <code>divisor_sum</code> subroutine returns the sum of all divisors of a number (including itself), so that he had to subtract the input number from the sums of its divisors in order to obtain the sum of <em>proper</em> divisors.</p>
<p><a href="https://github.com/manwar/perlweeklychallenge-club/blob/master/challenge-020/feng-chang/perl6/ch-2.p6">Feng Chang</a> made a very nice and concise script using infinite lists:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-perl6" data-lang="perl6"><span style="color:#66d9ef">my</span> @a <span style="color:#f92672">=</span> (<span style="color:#ae81ff">0</span><span style="color:#f92672">..</span><span style="color:#960050;background-color:#1e0010">∞</span>)<span style="color:#f92672">.</span>map:  { sod($_) };
<span style="color:#66d9ef">my</span> @b <span style="color:#f92672">=</span> (<span style="color:#ae81ff">0</span><span style="color:#f92672">..</span><span style="color:#960050;background-color:#1e0010">∞</span>)<span style="color:#f92672">.</span>grep: { @a[$_] <span style="color:#f92672">&gt;</span> $_ <span style="color:#f92672">and</span> @a[@a[$_]] <span style="color:#f92672">==</span> $_ };
say(@b[<span style="color:#ae81ff">0</span>], <span style="color:#e6db74">&#39; &#39;</span>, @a[@b[<span style="color:#ae81ff">0</span>]]);
<span style="color:#75715e"># sum of proper divisors</span>
<span style="color:#66d9ef">sub</span> <span style="color:#a6e22e">sod</span>(UInt $n) {
    [<span style="color:#f92672">+</span>] (<span style="color:#ae81ff">1</span> <span style="color:#f92672">..</span> $n<span style="color:#f92672">/</span><span style="color:#ae81ff">2</span>)<span style="color:#f92672">.</span>grep: { $n %% <span style="color:#960050;background-color:#1e0010">$</span>_ }
}
</code></pre></div><p><a href="https://github.com/manwar/perlweeklychallenge-club/blob/master/challenge-020/jaldhar-h-vyas/perl6/ch-2.p6">Jaldhar H. Vyas</a> used Thābit ibn Qurra&rsquo;s theorem to generate the first pair of amicable numbers. As mentioned above, I believe this is a bit dangerous since this method cannot generate an exhaustive list of such pairs, so we are not really guaranteed to find the first pair. As it turns out, though, this method does yield the first pair, so that Jaldhar&rsquo;s result is nonetheless correct.</p>
<p><a href="https://github.com/manwar/perlweeklychallenge-club/blob/master/challenge-020/joelle-maslak/perl6/ch-2.p6">Joelle Maslak</a>&lsquo;s <code>factorsum</code> subroutine is probably more efficient than my <code>sum-divisors</code> subroutine (and is certainly faster for large input integers) because it iterates up to the square root of the input number (instead of going up to half the input number in my subroutine) and then computes the other larger divisors (for example, when looking for the divisors of 12, my subroutine iterates until 6, whereas Joelle&rsquo;s subroutine only needs to iterate until 3, obtains 2 and 3, and then finds 6 by dividing 12 by 2 and 4 by dividing 12 by 3; this probably doesn&rsquo;t improve very much performance for a small number such as 12, but it undoubtedly does for larger numbers). In addition, she caches the results with the <code>is cached</code> trait. In addition, her code is also a pretty beautiful clockwork of functional programming with two nice data pipelines.</p>
<p><a href="https://github.com/manwar/perlweeklychallenge-club/blob/master/challenge-020/roger-bell-west/perl6/ch-2.p6">Roger Bell West</a>&lsquo;s <code>divisors_unself</code> subroutine also iterates only up to the square root of the input number, using essentially the same method as Joelle to generate the missing divisors above the square root. As noted just above, this is likely to be significantly faster for large input integers.</p>
<h2 id="enter-damian-conway">Enter Damian Conway</h2>
<p>Also known as <a href="https://www.perlmonks.org/?node_id=107600">TheDamian</a>, Damian Conway wrote (as usual) the most definitive analysis on the subject in his <a href="http://blogs.perl.org/users/damian_conway/2019/08/with-friends-like-these.html">With friends as these&hellip;</a> blog post. On top of that, it is really well-written.</p>
<p>I will not try to summarize Damian&rsquo;s master piece, you should really follow the link and read it, but I will only highlight a few points.</p>
<p>Given a function that returns the divisors of a number, Damian says it is easy enough to iterate through each integer from 1 to infinity, find its divisors, then check to see if the sum-of-divisors of that number is identical to the original number (pretty much what I did in the main code on my script at the beginning of this post). Then, the article goes on to study how to do it if we want to find more than one amicable pair. Of course, in such a case, the performance issues that I originally brushed aside because we only needed the first pair now need to be re-examined.</p>
<p>The problem is that, since Perl 6 does not have a built-in function that returns the proper divisors of a number, we obviously need to write one. Damian comes up with a handful of such subroutines using the naive trial division algorithm, for example:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-perl6" data-lang="perl6">multi divisors (<span style="color:#f92672">\</span>N) { (<span style="color:#ae81ff">1</span><span style="color:#f92672">..</span>N)<span style="color:#f92672">.</span>grep(N %% <span style="color:#960050;background-color:#1e0010">*</span>) }
</code></pre></div><p>The problem with it is that it is very inefficient when the input numbers become large. The first thing that Damian does is more or less the same improvement that Joelle and Roger used: iterate up to the square root of the input number and compute the larger missing divisors as the division of the input integer by each of the smaller divisors. For example:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-perl6" data-lang="perl6">multi divisors (<span style="color:#f92672">\</span>N) {
    <span style="color:#66d9ef">my</span> <span style="color:#f92672">\</span>small<span style="color:#f92672">-</span>divisors <span style="color:#f92672">=</span> (<span style="color:#ae81ff">1</span><span style="color:#f92672">..</span>sqrt N)<span style="color:#f92672">.</span>grep(N %% <span style="color:#960050;background-color:#1e0010">*</span>);
    <span style="color:#66d9ef">my</span> <span style="color:#f92672">\</span>big<span style="color:#f92672">-</span>divisors   <span style="color:#f92672">=</span> N <span style="color:#960050;background-color:#1e0010">«</span>div<span style="color:#960050;background-color:#1e0010">«</span> small<span style="color:#f92672">-</span>divisors;
    <span style="color:#66d9ef">return</span> unique flat small<span style="color:#f92672">-</span>divisors, big<span style="color:#f92672">-</span>divisors;
}
</code></pre></div><p>This is vastly more efficient. The performance of the <code>divisors</code> subroutine up to <code>divisors(10**9)</code> is entirely acceptable at under 0.1 seconds, but starts to fall off rapidly after that point. What if we want to go further?</p>
<p>Cryptographers have designed a number of more efficient algorithms to find the factors of an integer. One of them is <a href="https://en.wikipedia.org/wiki/Pollard%27s_rho_algorithm">Pollard’s 𝜌 algorithm</a>, which is implemented in the <code>prime-factors</code> function of a Perl 6 module named <a href="https://github.com/thundergnat/Prime-Factor/blob/master/lib/Prime/Factor.pm6">Prime::Factor</a> by Stephen Schulze. This function finds all the prime factors of a large input number very quickly. But the prime factors of a number isn&rsquo;t the same thing as its divisors. But we can use prime factors to compute the divisors by combining the factors in all possible ways. Except that if we use the naive approach of finding all combinations of prime factors, the program becomes catastrophically slow because of <a href="https://en.wikipedia.org/wiki/Combinatorial_explosion">combinatorial explosion</a>.  Damian then shows how storing the prime factors in a <code>Bag</code> data structure makes it possible to test every possible combination of the prime factors exponents (the values of the bag). And the new version based on this idea scales incredibly better than any previous implementation: the program can find the divisors of a number with 100 digits in less than half a second.</p>
<p>Damian makes two additional points. One is that the new version of the <code>divisors</code> is a lot faster for very large numbers, but that, for smaller numbers (below about 10,000), iterating trial division to the square root of the input integer is faster. He then shows how easy it is to make two <code>multi</code> versions of the <code>divisors</code> subroutine, one for small numbers and one for big ones.  Finally, Damian demonstrates how adding a single word, the <code>hyper</code> prefix, to his main <code>for</code> loop enables concurrency and makes the overall program about twice as fast.</p>
<p>I hope that I have opened your appetite. Once again, you should really follow <a href="http://blogs.perl.org/users/damian_conway/2019/08/with-friends-like-these.html">the link</a> to Damian&rsquo;s post and read it in detail. It&rsquo;s really worth it.</p>
<h2 id="wrapping-up">Wrapping up</h2>
<p>Please let me know if I forgot any of the challengers or if you think my explanation of your code misses something important.</p>
<p>If you want to participate to the Perl Weekly Challenge, please connect to <a href="https://perlweeklychallenge.org/">this site</a>.</p>
<h2 id="see-also">See Also</h2>
<p>See also the following blog posts:</p>
<ul>
<li>Arne Sommer: <a href="https://perl6.eu/amicable-split.html">https://perl6.eu/amicable-split.html</a></li>
<li>Adam Russell: <a href="https://adamcrussell.livejournal.com/6526.html">https://adamcrussell.livejournal.com/6526.html</a></li>
<li>Roger Bell West: <a href="https://blog.firedrake.org/archive/2019/08/Perl_Weekly_Challenge_20.html">https://blog.firedrake.org/archive/2019/08/Perl_Weekly_Challenge_20.html</a></li>
<li>Jaldhar Y. Vyas: <a href="https://www.braincells.com/perl/2019/08/perl_weekly_challenge_week_20.html">https://www.braincells.com/perl/2019/08/perl_weekly_challenge_week_20.html</a></li>
<li>Damian Conway: <a href="http://blogs.perl.org/users/damian_conway/2019/08/with-friends-like-these.html">http://blogs.perl.org/users/damian_conway/2019/08/with-friends-like-these.html</a></li>
</ul>
<p>*Update: *
Yary did not participate to the challenge, but posted on Aug. 22, 2019 <a href="http://blogs.perl.org/users/yary/2019/08/splitting-on-a-change-challenge-20-task-1.html">Splitting on a change, Challenge 20 Task 1</a> that notices that the challenge asked &ldquo;to accept a string from command line and split it on change of character&rdquo;, and further comments: &ldquo;But every solution that I read in the recap looked for runs of the same character instead of the literal interpretation of the challenge.&rdquo; I&rsquo;m not sure whether I fully understand his objection, as these seem equivalent to me, but I guess that Yary would like to see something that detects directly places where there is a character change.. The blog&rsquo;s code examples are mainly in Perl 5, but the last one is in Perl 6:</p>
<pre><code>say &quot;ABBCDEEF&quot;.split(/&lt;?before (.) {} :my $c=$0;&gt;&lt;!after $c&gt; /).perl
(&quot;&quot;, &quot;A&quot;, &quot;BB&quot;, &quot;C&quot;, &quot;D&quot;, &quot;EE&quot;, &quot;F&quot;).Seq
</code></pre>
<p>Yary further asks: any idea on how to remove the spurious empty string at the beginning?</p>
<h2 id="wrapping-up-1">Wrapping up</h2>
<p>Please let me know if I forgot any of the challengers or if you think my explanation of your code misses something important.</p>
<p>If you want to participate to the Perl Weekly Challenge, please connect to <a href="https://perlweeklychallenge.org/">this site</a>.</p>

                </div>
            </div>
        </div>
    </div>
</section>


<!-- Call To Action Section Start -->
<section id="call-to-action">
    <div class="container">
        <div class="row">
            <div class="col-md-12">
                <div class="block">
                    <h2 class="title wow fadeInDown" data-wow-delay=".3s" data-wow-duration="500ms">SO WHAT DO YOU THINK ?</h2>
                    <p class="wow fadeInDown" data-wow-delay=".5s" data-wow-duration="500ms">If you have any suggestions or ideas then please do share with us.</p>
                    <a href="mailto:mohammad.anwar@yahoo.com" class="btn btn-default btn-contact wow fadeInDown" data-wow-delay=".7s" data-wow-duration="500ms">Contact with me</a>
                </div>
            </div>

        </div>
    </div>
</section>
<!-- Call To Action Section End -->



<!-- Footer Section Start -->
<footer id="footer">
    <div class="container">
        <div class="row content-justify-between">
            <div class="col-md-8 col-12 text-center text-lg-left text-md-left">
                <p class="copyright">Copyright:
                    <span>
                        2019 - 2025
                    </span> The Weekly Challenge. Theme Design and Developed by
                    <a href="http://www.Themefisher.com" rel="noreferrer" rel="noreferrer" target="_blank">Themefisher</a>.
                </p>
            </div>
            <div class="col-md-4 col-12">
                <!-- Social Media -->
                <ul class="social text-center text-md-right text-lg-right">
                    <li>
                        <a href="https://twitter.com/PerlWChallenge" class="twitter" rel="noreferrer" target="_blank" title="Follow us">
                            <i class="ion-social-twitter"></i>
                        </a>
                    </li>
                    <li>
                        <a href="/rss.xml" class="rss" target="_blank" title="RSS Feed">
                            <i class="ion-social-rss"></i>
                        </a>
                    </li>
                </ul>
            </div>
        </div>
    </div>
</footer>
<!-- footer section end -->

<!-- jquery -->
<script src="https://theweeklychallenge.org/plugins/jquery/jquery.min.js"></script>
<!-- Form Validation -->
<script src="https://theweeklychallenge.org/plugins/form-validation/jquery.form.min.js"></script>
<script src="https://theweeklychallenge.org/plugins/form-validation/jquery.validate.min.js"></script>
<!-- slick slider -->
<script src="https://theweeklychallenge.org/plugins/slick/slick.min.js"></script>
<!-- bootstrap js -->
<script src="https://theweeklychallenge.org/plugins/bootstrap/bootstrap.min.js"></script>
<!-- chart js -->
<script src="https://theweeklychallenge.org/plugins/chart/highstock.js"></script>
<script src="https://theweeklychallenge.org/plugins/chart/drilldown.js"></script>
<script src="https://theweeklychallenge.org/plugins/chart/data.js"></script>
<script src="https://theweeklychallenge.org/plugins/chart/chart.js"></script>
<script src="https://theweeklychallenge.org/plugins/chart/pwc-challenge.js"></script>
<script src="https://theweeklychallenge.org/plugins/chart/gc-challenge.js"></script>
<!-- wow js -->
<script src="https://theweeklychallenge.org/plugins/wow-js/wow.min.js"></script>
<!-- slider js -->
<script src="https://theweeklychallenge.org/plugins/slider/slider.js"></script>
<!-- Fancybox -->
<script src="https://theweeklychallenge.org/plugins/facncybox/jquery.fancybox.js"></script>
<!-- template main js -->

<script src="https://theweeklychallenge.org/js/script.min.js"></script>
<!-- google analitycs -->

<script async src="https://www.googletagmanager.com/gtag/js?id=G-CJTPYM9SB8"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-CJTPYM9SB8');
</script>
</body>

</html>

